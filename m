Return-Path: <SRS0=eTRQ=EM=vger.kernel.org=git-owner@kernel.org>
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on
	aws-us-west-2-korg-lkml-1.web.codeaurora.org
X-Spam-Level: 
X-Spam-Status: No, score=-5.3 required=3.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VALID,HEADER_FROM_DIFFERENT_DOMAINS,MAILING_LIST_MULTI,NICE_REPLY_A,
	SPF_HELO_NONE,SPF_PASS,USER_AGENT_SANE_1 autolearn=no autolearn_force=no
	version=3.4.0
Received: from mail.kernel.org (mail.kernel.org [198.145.29.99])
	by smtp.lore.kernel.org (Postfix) with ESMTP id 92160C4742C
	for <git@archiver.kernel.org>; Fri,  6 Nov 2020 01:44:23 +0000 (UTC)
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.kernel.org (Postfix) with ESMTP id 1425220759
	for <git@archiver.kernel.org>; Fri,  6 Nov 2020 01:44:23 +0000 (UTC)
Authentication-Results: mail.kernel.org;
	dkim=pass (2048-bit key) header.d=plus.com header.i=@plus.com header.b="WvAmlwYj"
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1732854AbgKFBoW (ORCPT <rfc822;git@archiver.kernel.org>);
        Thu, 5 Nov 2020 20:44:22 -0500
Received: from avasout02.plus.net ([212.159.14.17]:58384 "EHLO
        avasout02.plus.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S2387469AbgKFBoV (ORCPT <rfc822;git@vger.kernel.org>);
        Thu, 5 Nov 2020 20:44:21 -0500
Received: from [10.0.2.15] ([80.189.83.69])
        by smtp with ESMTPA
        id aqnbkOWV20K1Oaqncke8Ur; Fri, 06 Nov 2020 01:44:20 +0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=plus.com; s=042019;
        t=1604627060; bh=tJM4NtHWi/2jpZeQijuUqvXcN7gyAQ77uZxvGG3PmnI=;
        h=Subject:To:Cc:References:From:Date:In-Reply-To;
        b=WvAmlwYjl/yb99fpyN06vCPk+x4nI+jscS6aw2yMA8XBu8o/Tass/T6jP79+k6FYq
         2N1k2c5dzDtEFp/YSTcj7m94xtckYePoMlpwEbKxgHPyY50ukBX5OoPvRzlPOVEUIl
         6P6VFfmCH7nvHC/YskSvYZ1HwijyhoEoqlgGyEG5slIuzO2FxGegoJLaIhEfCGj8HW
         5r5kxlhWfOx7bOTy2QOsdLIJ4uklBIST9V7WAhdlAECW2ROHwDpTzOS3uQWpdEtW/2
         osPYaqvY4F4tjFPgeZ8StDKCSsTTqMAz3SniFKNJUN/iElHd6hqxjKTp99V6c9XKPm
         Wh2/9S6QRzNkw==
X-Clacks-Overhead: "GNU Terry Pratchett"
X-CM-Score: 0.00
X-CNFS-Analysis: v=2.3 cv=QaP9QvTv c=1 sm=1 tr=0
 a=VKYMt3kHM3Z9lWmoeJedNA==:117 a=VKYMt3kHM3Z9lWmoeJedNA==:17
 a=IkcTkHD0fZMA:10 a=ybZZDoGAAAAA:8 a=PDv52iShTv2UyWVZjh8A:9 a=QEXdDO2ut3YA:10
 a=0RhZnL1DYvcuLYC8JZ5M:22
X-AUTH: ramsayjones@:2500
Subject: Re: [PATCH 7/8] Makefile: don't delete dist tarballs directly by name
To:     Junio C Hamano <gitster@pobox.com>
Cc:     GIT Mailing-list <git@vger.kernel.org>
References: <48fdd198-93ad-7282-27e6-9a0c6de93067@ramsayjones.plus.com>
 <xmqqr1p7h38t.fsf@gitster.c.googlers.com>
 <xmqqeel7h0aj.fsf@gitster.c.googlers.com>
From:   Ramsay Jones <ramsay@ramsayjones.plus.com>
Message-ID: <0cbe821b-092d-a5f9-e2ab-13a3c01e9a02@ramsayjones.plus.com>
Date:   Fri, 6 Nov 2020 01:44:18 +0000
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.10.0
MIME-Version: 1.0
In-Reply-To: <xmqqeel7h0aj.fsf@gitster.c.googlers.com>
Content-Type: text/plain; charset=utf-8
Content-Language: en-GB
Content-Transfer-Encoding: 7bit
X-CMAE-Envelope: MS4wfKfQc8SZeVa0OQAY9E6QODE/Ms7Zc7k6Ub+nrB7a9SN8pniOYlRJnS69rIpJMH5b8AwOpWRhXxG1+byAksf4VNfbK47R0Tqsx/XuYT5hzGG0OH645Lbm
 9kHTC+xIQJQFvZYQH7CYCp51AD7tJeq62vbqlOgEf93fYbVWU5HA/aTy+dwVZanoucc+7DkQmWkf7g==
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org



On 05/11/2020 23:05, Junio C Hamano wrote:
> Junio C Hamano <gitster@pobox.com> writes:
[snip]
>> Sorry, but I'd rather not to see such a longer-term "list of files
>> to be removed" on the filesystem.  This invites attackers to write a
>> rogue test addition that writes into ../../dist-tars something like
>> "~/.gitconfig" and wait for me to say "make clean".
> 
> Having said that, I also think that "make clean" target should help
> your desire to keep tarballs that would not have been generated by
> the current checkout (e.g. the last release), and I do not think
> 
> 	$(RM) git-htmldocs-*.tar.gz git-manpages-*.tar.gz
> 
> is an unconditionally better alternative to what you did in this
> step.
> 
> How about moving removal of these "distribution" artifacts that are
> created by "make dist$something" targets from "clean" to "distclean"?

I did have a patch #9 that moved the removal of the tarballs from
the 'clean' target to the 'distclean' target (that is move the new
'iterate over the dist-tars file' code). However, I wasn't convinced
that it was a better place for it.

Also, just moving the new removal code would not alter the concerns
about it that you express above. So, we need to address that either
way.

Thanks.

ATB,
Ramsay Jones



