From: Junio C Hamano <junkio@cox.net>
Subject: Re: Making perl scripts include the correct Git.pm
Date: Sun, 02 Jul 2006 17:02:30 -0700
Message-ID: <7v64if1rop.fsf@assigned-by-dhcp.cox.net>
References: <20060702214012.GI29115@pasky.or.cz>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Cc: git@vger.kernel.org
X-From: git-owner@vger.kernel.org Mon Jul 03 02:02:35 2006
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git@gmane.org
Received: from vger.kernel.org ([209.132.176.167])
	by ciao.gmane.org with esmtp (Exim 4.43)
	id 1FxBtb-0002ZC-1v
	for gcvg-git@gmane.org; Mon, 03 Jul 2006 02:02:35 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1750723AbWGCACc (ORCPT <rfc822;gcvg-git@m.gmane.org>);
	Sun, 2 Jul 2006 20:02:32 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1750788AbWGCACc
	(ORCPT <rfc822;git-outgoing>); Sun, 2 Jul 2006 20:02:32 -0400
Received: from fed1rmmtao08.cox.net ([68.230.241.31]:18091 "EHLO
	fed1rmmtao08.cox.net") by vger.kernel.org with ESMTP
	id S1750723AbWGCACb (ORCPT <rfc822;git@vger.kernel.org>);
	Sun, 2 Jul 2006 20:02:31 -0400
Received: from assigned-by-dhcp.cox.net ([68.4.9.127])
          by fed1rmmtao08.cox.net
          (InterMail vM.6.01.06.01 201-2131-130-101-20060113) with ESMTP
          id <20060703000231.DCAB27967.fed1rmmtao08.cox.net@assigned-by-dhcp.cox.net>;
          Sun, 2 Jul 2006 20:02:31 -0400
To: Petr Baudis <pasky@suse.cz>
In-Reply-To: <20060702214012.GI29115@pasky.or.cz> (Petr Baudis's message of
	"Sun, 2 Jul 2006 23:40:13 +0200")
User-Agent: Gnus/5.110006 (No Gnus v0.6) Emacs/21.4 (gnu/linux)
Sender: git-owner@vger.kernel.org
Precedence: bulk
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/23139>

Petr Baudis <pasky@suse.cz> writes:

> so this is my attempt to summarize it:

Ah, our message crossed -- thanks for summarizing it.  I do not
particularly like any of the solution so far, but maybe the
patch I just sent out to "do the normal thing unless we are
running tests" might be the right thing to do.

>   (ii) My proposed second solution was to add an autogenerated line to
> the Git's perl scripts saying something like:
>
> 	use lib ('instlibdir', 'srclibdir');
>
> This fulfills all (D1), (D2) and (D3)

If you have srclibdir after instlibdir, aren't you breaking D2?

And I do not think swapping them is right either.  It would
fullfil D1/D2/D3 but I think it has one bad side effect.

Namely, I do not want an installed script, maybe coming from the
vendor, to be affected by whatever unrelated garbage the end
user happens to have on the same path as the one used for
building the module on potentially remote machine, so I would
like to avoid including srclibdir anywhere on the include path
for normal execution.

That is, if I built a binary package in /home/junio/git/git.git
on my machine to be installed in /usr/lib/perl/somewhere, the
users on a multi-user system can be tricked to run random stuff
that happens to be in /home/junio/git/git.git/ directory on
their machine.
