Return-Path: <git-owner@vger.kernel.org>
X-Spam-Checker-Version: SpamAssassin 3.4.1 (2015-04-28) on dcvr.yhbt.net
X-Spam-Level: 
X-Spam-ASN: AS31976 209.132.180.0/23
X-Spam-Status: No, score=-4.1 required=3.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VALID,DKIM_VALID_AU,HEADER_FROM_DIFFERENT_DOMAINS,MAILING_LIST_MULTI,
	RCVD_IN_DNSWL_HI shortcircuit=no autolearn=ham autolearn_force=no
	version=3.4.1
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by dcvr.yhbt.net (Postfix) with ESMTP id 9D3171F516
	for <e@80x24.org>; Fri, 22 Jun 2018 01:09:52 +0000 (UTC)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S933868AbeFVBJu (ORCPT <rfc822;e@80x24.org>);
        Thu, 21 Jun 2018 21:09:50 -0400
Received: from smtp.codeaurora.org ([198.145.29.96]:55152 "EHLO
        smtp.codeaurora.org" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S933129AbeFVBJu (ORCPT <rfc822;git@vger.kernel.org>);
        Thu, 21 Jun 2018 21:09:50 -0400
Received: by smtp.codeaurora.org (Postfix, from userid 1000)
        id 993D460791; Fri, 22 Jun 2018 01:09:49 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=codeaurora.org;
        s=default; t=1529629789;
        bh=l62Yzc/IV0vIj9Fn5LukTCo+TrIlizidadd5yoqS5zk=;
        h=From:To:Subject:Date:From;
        b=cJtH561zTWN0x8vXp8eQv4ypNJSEMceBVjQLEm/Wg+Yu2X15fgFrfd5J9FgDsYt6B
         YQBZYJtry/j1DiIQzqgNzoNVe7eukm3n+2hnVdCpDnsZqZusEiS8oyqdKGfnJrqW4J
         GQhD8FHx6bd7bNwRnAuQJQkLr7gGjZf/gpLpecDE=
Received: from JBING (i-global254.qualcomm.com [199.106.103.254])
        (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
        (No client certificate requested)
        (Authenticated sender: jbing@codeaurora.org)
        by smtp.codeaurora.org (Postfix) with ESMTPSA id 3457360264
        for <git@vger.kernel.org>; Fri, 22 Jun 2018 01:09:49 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=codeaurora.org;
        s=default; t=1529629789;
        bh=l62Yzc/IV0vIj9Fn5LukTCo+TrIlizidadd5yoqS5zk=;
        h=From:To:Subject:Date:From;
        b=cJtH561zTWN0x8vXp8eQv4ypNJSEMceBVjQLEm/Wg+Yu2X15fgFrfd5J9FgDsYt6B
         YQBZYJtry/j1DiIQzqgNzoNVe7eukm3n+2hnVdCpDnsZqZusEiS8oyqdKGfnJrqW4J
         GQhD8FHx6bd7bNwRnAuQJQkLr7gGjZf/gpLpecDE=
DMARC-Filter: OpenDMARC Filter v1.3.2 smtp.codeaurora.org 3457360264
Authentication-Results: pdx-caf-mail.web.codeaurora.org; dmarc=none (p=none dis=none) header.from=codeaurora.org
Authentication-Results: pdx-caf-mail.web.codeaurora.org; spf=none smtp.mailfrom=jbing@codeaurora.org
From:   "Jehan Bing" <jbing@codeaurora.org>
To:     <git@vger.kernel.org>
Subject: BUG: sub-git files getting cleaned when using --exclude in the top git
Date:   Thu, 21 Jun 2018 18:09:48 -0700
Message-ID: <006b01d409c5$b7898f80$269cae80$@codeaurora.org>
MIME-Version: 1.0
Content-Type: text/plain;
        charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQIuxZ6/SACrghm1dRv0fKaMlFwD5Q==
Content-Language: en-us
Sender: git-owner@vger.kernel.org
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org

Hi,

I have a setup with tree of 250+ git repositories. Every now and then, I
want to clean everything except for files generated by my IDE. So for =
all
the git repos, I run =93git clean -dfx --exclude <ide file>=94. What =
happens
then is, if a sub-git as that file, all its files are deleted (except =
for
that ide file) instead of being skipped.

Here is a simplified setup:
       git init a
       cd a
       git init b
       touch b/1 b/2

Now, if I run (from a):
       git clean -dfx
git says =93Skipping repository b/=94 and nothing is cleaned, as =
expected.

But if I run:
       git clean -dfx -e 1
then there is no =93skipping=94 message and b/2 is deleted even if it is =
a file
tracked by b.
I would expect b to still be skipped and left untouched.


Regards,
=A0 Jehan



