From: Eric Sunshine <sunshine@sunshineco.com>
Subject: Re: [PATCH v3 2/4] generate-cmdlist.sh: parse common command groups
Date: Sun, 3 May 2015 16:10:55 -0400
Message-ID: <CAPig+cTNzOYjKqM4R9ajAAH6jn1xoDpr=GUz1Guyo3kNjrEviw@mail.gmail.com>
References: <554405D5.9080702@gmail.com>
	<55456990.6000509@gmail.com>
	<55456A40.80806@gmail.com>
	<CAPig+cQNOEgZAn=2MXNjkUxnMA+OimTLfSmEMskZsvRv-Zh42w@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: QUOTED-PRINTABLE
Cc: Git List <git@vger.kernel.org>, Luke Diamand <luke@diamand.org>,
	Andreas Schwab <schwab@linux-m68k.org>,
	Junio C Hamano <gitster@pobox.com>
To: =?UTF-8?Q?S=C3=A9bastien_Guimmara?= <sebastien.guimmara@gmail.com>
X-From: git-owner@vger.kernel.org Sun May 03 22:11:02 2015
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git-2@plane.gmane.org
Received: from vger.kernel.org ([209.132.180.67])
	by plane.gmane.org with esmtp (Exim 4.69)
	(envelope-from <git-owner@vger.kernel.org>)
	id 1Yp0E8-00084h-Ng
	for gcvg-git-2@plane.gmane.org; Sun, 03 May 2015 22:11:01 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1751872AbbECUK5 convert rfc822-to-quoted-printable (ORCPT
	<rfc822;gcvg-git-2@m.gmane.org>); Sun, 3 May 2015 16:10:57 -0400
Received: from mail-ig0-f178.google.com ([209.85.213.178]:38103 "EHLO
	mail-ig0-f178.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1751670AbbECUK4 convert rfc822-to-8bit (ORCPT
	<rfc822;git@vger.kernel.org>); Sun, 3 May 2015 16:10:56 -0400
Received: by igbhj9 with SMTP id hj9so70135250igb.1
        for <git@vger.kernel.org>; Sun, 03 May 2015 13:10:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:sender:in-reply-to:references:date:message-id:subject
         :from:to:cc:content-type:content-transfer-encoding;
        bh=hqvDm/802UZoDpAlUiyhrsDbM1RLzmVpN468RaikKfE=;
        b=ke9/2hmISV0aLQSDnxuQ+ZbznIkZrIQqVf2/QKSASIyrdywCVAzy/YXkk6upkDAI9Y
         J5w3VxhJDLhj95/lFiBQeLbA3Jpd1eVqfddvLdjKnGhvMOsAVKdy7WyTe6s5yLdwitYu
         cvGYqDECzxL5WkfKgvdFkFa9tOS+m6SPSTpye+HzZlE+49RC6XNA1VTzV/jDEdhKc3aT
         2IPotN01AqbdBdVFEUl4XRuIP/kRoiFFXXSDwhOI/wZmPbwm81NM7YsWeIlT+Xqd3kTn
         7kwfH/YQcPSz55W2ybdRycDkcknpvK0RB3mV4uM8SNsjMSZqqjuBqLEDRDTsfamYItnG
         faeQ==
X-Received: by 10.107.31.134 with SMTP id f128mr24226678iof.19.1430683855675;
 Sun, 03 May 2015 13:10:55 -0700 (PDT)
Received: by 10.107.28.132 with HTTP; Sun, 3 May 2015 13:10:55 -0700 (PDT)
In-Reply-To: <CAPig+cQNOEgZAn=2MXNjkUxnMA+OimTLfSmEMskZsvRv-Zh42w@mail.gmail.com>
X-Google-Sender-Auth: ehTnE4IiWH1wIdjwqT1lEPooDgM
Sender: git-owner@vger.kernel.org
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/268289>

On Sun, May 3, 2015 at 3:18 PM, Eric Sunshine <sunshine@sunshineco.com>=
 wrote:
> On Sat, May 2, 2015 at 8:22 PM, S=C3=A9bastien Guimmara
> <sebastien.guimmara@gmail.com> wrote:
>> ---
>> diff --git a/generate-cmdlist.sh b/generate-cmdlist.sh
>> index 9a4c9b9..98f937b 100755
>> --- a/generate-cmdlist.sh
>> +++ b/generate-cmdlist.sh
>> @@ -4,19 +4,20 @@ echo "/* Automatically generated by $0 */
>>  };
>>   static struct cmdname_help common_cmds[] =3D {"
>>  -sed -n -e 's/^git-\([^ ]*\)[ ].* common.*/\1/p' [...]
>> +sed -n -e 's/^git-\([^ ]*\)[ ].* common-\(.*\)/\1:\2/p' [...]
>
> Isn't \(.*\) a bit too loose for grabbing $grp? What if someone some
> day adds another column to express some other sort of attribute? (Or,
> if someone perhaps uses the "deprecated" attribute but places it in
> column 3 rather than 2 as documented.) It probably would be better to
> tighten this up by grabbing only non-whitespace characters, as is
> already done for $cmd.
>
> (In fact, this sed invocation is already broken for "deprecated",
> isn't it? According to the command-list.txt header comments,
> "deprecated" should be placed before "common", yet the sed invocation
> expects "common" to follow the command immediately. Perhaps a
> preparatory patch could fix this issue; or just do away with
> "deprecated" entirely since it's not used.)

Ah, I misread the original sed invocation slightly. It's not broken,
so scratch the second paragraph.

(Though, it does expect at least one whitespace character and then one
space before "common", which is a bit odd, but not a problem with the
current content of command-list.txt.)
