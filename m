From: "Alex Riesen" <raa.lkml@gmail.com>
Subject: Another Perforce importer for git
Date: Mon, 14 Aug 2006 15:04:57 +0200
Message-ID: <81b0412b0608140604u75c6522brbc1bc83fc7c9c5c8@mail.gmail.com>
Mime-Version: 1.0
Content-Type: multipart/mixed; 
	boundary="----=_Part_138486_22092783.1155560697217"
X-From: git-owner@vger.kernel.org Mon Aug 14 15:05:29 2006
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git@gmane.org
Received: from vger.kernel.org ([209.132.176.167])
	by ciao.gmane.org with esmtp (Exim 4.43)
	id 1GCc8B-00007o-P5
	for gcvg-git@gmane.org; Mon, 14 Aug 2006 15:05:24 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1750722AbWHNNE7 (ORCPT <rfc822;gcvg-git@m.gmane.org>);
	Mon, 14 Aug 2006 09:04:59 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1752022AbWHNNE7
	(ORCPT <rfc822;git-outgoing>); Mon, 14 Aug 2006 09:04:59 -0400
Received: from nf-out-0910.google.com ([64.233.182.187]:38466 "EHLO
	nf-out-0910.google.com") by vger.kernel.org with ESMTP
	id S1750722AbWHNNE7 (ORCPT <rfc822;git@vger.kernel.org>);
	Mon, 14 Aug 2006 09:04:59 -0400
Received: by nf-out-0910.google.com with SMTP id a4so67454nfc
        for <git@vger.kernel.org>; Mon, 14 Aug 2006 06:04:57 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=TDJ+2YJhBHEjp9B6TXZRd2XvC7NNcrhI1J879nkLOYU7jkIIWXenFQsYC9GjSA4jBmDhRi1/Bp9iNM6HYogM3FV5xSl88u07yuV0g7w9xNMt00U1r5M/Vda833q+9Y8YwyO+kZ7WpXbeoxvLwwwvU4kkbVI5Hed7Abvxo0MCZPU=
Received: by 10.78.193.5 with SMTP id q5mr3235634huf;
        Mon, 14 Aug 2006 06:04:57 -0700 (PDT)
Received: by 10.78.160.12 with HTTP; Mon, 14 Aug 2006 06:04:57 -0700 (PDT)
To: git@vger.kernel.org
Sender: git-owner@vger.kernel.org
Precedence: bulk
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/25352>

------=_Part_138486_22092783.1155560697217
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Just in case someone might ever need this: it imports
a _synced_ state into git repo. IOW, you sync down
the files as you were commanded (it's corporal, umm...
corporate, remember?) and run the script to create
a commit for you. You still have to run git-commit manually,
but don't have to pass "-a" to it (which can be dangerous,
and does not pick up the files recently added to p4 repo).

For the poor souls unlucky enough to be in windows
environment, a .bat is attached, too.

P4 has a better interoperability with python, so rewriting this
script in Python maybe a good idea.

------=_Part_138486_22092783.1155560697217
Content-Type: application/octet-stream; name=git-p4-import.perl
Content-Transfer-Encoding: base64
X-Attachment-Id: f_equuymqf
Content-Disposition: attachment; filename="git-p4-import.perl"

IyEvdXNyL2Jpbi9wZXJsIC13DQoNCmxvY2FsICRWRVJCT1NFID0gMDsNCmxvY2FsICREUllSVU4g
PSAwOw0KbG9jYWwgJFlFUyA9IDA7DQpsb2NhbCAkQVVUT19DT01NSVQgPSAxOw0KbG9jYWwgJE5P
UDRfQ0xJRU5UID0gdW5kZWY7DQpsb2NhbCBAUDRBUkdTID0gKCk7DQpwdXNoKEBQNEFSR1MsICct
UCcsICRFTlZ7UDRQQVNTV0R9KQ0KICAgIGlmIGRlZmluZWQoJEVOVntQNFBBU1NXRH0pIGFuZCBs
ZW5ndGgoJEVOVntQNFBBU1NXRH0pOw0KbG9jYWwgJGVkaXRvciA9ICRFTlZ7VklTVUFMfTsNCiRl
ZGl0b3IgPSAkRU5We0VESVRPUn0gdW5sZXNzIGRlZmluZWQoJGVkaXRvcik7DQpkaWUgIiQwOiBu
byBlZGl0b3IgZGVmaW5lZFxuIiB1bmxlc3MgZGVmaW5lZCgkZWRpdG9yKTsNCg0Kc3ViIHJlYWRf
YXJncyB7DQogICAgbXkgKCRpbl9jbGllbnQpID0gKDApOw0KICAgIGZvcmVhY2ggbXkgJGYgKCBA
XyApIHsNCglpZiAoICRpbl9jbGllbnQgKSB7ICRpbl9jbGllbnQgPSAwOyAkTk9QNF9DTElFTlQg
PSAkZjsgbmV4dCB9DQoJJERSWVJVTj0xLCBuZXh0IGlmICRmIGVxICctbicgb3IgJGYgZXEgJy0t
ZHJ5LXJ1bic7DQoJJFlFUz0xLCBuZXh0IGlmICRmIGVxICcteScgb3IgJGYgZXEgJy0teWVzJzsN
CgkkVkVSQk9TRT0xLCBuZXh0IGlmICRmIGVxICctdicgb3IgJGYgZXEgJy0tdmVyYm9zZSc7DQoJ
JGluX2NsaWVudCA9IDEsIG5leHQgaWYgJGYgZXEgJy1jJzsNCiAgICB9DQp9DQpyZWFkX2FyZ3Mo
QEFSR1YpOw0KDQpkaWUgIiQwOiBQNCBjbGllbnQgbm90IGRlZmluZWRcbiIgdW5sZXNzIGRlZmlu
ZWQoJE5PUDRfQ0xJRU5UKTsNCmxvY2FsICgkUDRST09ULCAkUDRDTElFTlQsICRQNEhPU1QpOw0K
bXkgQHNwZWMgPSBncmVwIHsNCiAgICBpZiAoIG0vXlxzKlJvb3Q6XHMqKFxTKylbXFxcL10qXHMq
JC9zbyApIHsgJFA0Uk9PVCA9ICQxOyAxIH0NCiAgICBlbHNpZiAoIG0vXlxzKkNsaWVudDpccyoo
XFMrKS9vICkgeyAkUDRDTElFTlQgPSAkMTsgMSB9DQogICAgZWxzaWYgKCBtL15ccypIb3N0Olxz
KihcUyspL28gKSB7ICRQNEhPU1QgPSAkMTsgMSB9DQogICAgZWxzZSB7IDAgfQ0KfSBxeHtwNCBA
UDRBUkdTIGNsaWVudCAtbyAkTk9QNF9DTElFTlR9Ow0KDQpsb2NhbCAoJEdJVF9ESVIpPXF4e2dp
dCByZXYtcGFyc2UgLS1naXQtZGlyfTsNCmNob21wKCRHSVRfRElSKTsNCmRpZSAiJDA6ICRHSVRf
RElSIGlzIG5vdCBnaXQgZGlyZWN0b3J5XG4iIHVubGVzcyAtZCAkR0lUX0RJUjsNCg0KJC8gPSAi
XDAiOw0KbXkgJWdpdF9pbmRleCA9ICgpOw0KZm9yZWFjaCAoIHF4e2dpdCBscy1maWxlcyAtLWNh
Y2hlZCAten0gKSB7DQogICAgY2hvcDsNCiAgICBuZXh0IGlmIG0vXlwuKHA0c218bm9wNClcLy9v
Ow0KICAgIG5leHQgaWYgbS9eXC5naXRpZ25vcmUkL287DQogICAgbmV4dCBpZiBtL1wvXC5naXRp
Z25vcmUkL287DQogICAgJGdpdF9pbmRleHskX30gPSAxOw0KfQ0KDQpteSBAZ2l0X2FkZCA9ICgp
Ow0KbXkgQGdpdF9kZWwgPSAoKTsNCm15IEBnaXRfdXBkID0gKCk7DQoNCmxvY2FsICVnaXRpZ25v
cmVfZGlycyA9ICgpOw0KJGdpdGlnbm9yZV9kaXJzeycvJ30gPSByZWFkX2ZpbHRlcl9maWxlKCIk
R0lUX0RJUi9pbmZvL2V4Y2x1ZGUiKTsNCnB1c2goQHskZ2l0aWdub3JlX2RpcnN7Jy8nfX0sIEB7
cmVhZF9maWx0ZXJfZmlsZSgnLmdpdGlnbm9yZScpfSk7DQoNCiMgc3RhdHMNCmxvY2FsICgkQ29u
ZmxpY3RzLCRJZ25vcmVkLCRBZGRlZCwkRGVsZXRlZCwkVXBkYXRlZCkgPSAoMCwwLDAsMCwwKTsN
CiQvID0gIlxuIjsNCm15ICRpbl9uYW1lID0gMDsNCm15IEByb290ID0gc3BsaXQoL1tcL1xcXSsv
LCAkUDRST09UKTsNCm15ICVwNF9pbmRleCA9ICgpOw0KbXkgJXA0X2FfbGMgPSAoKTsNCmZvcmVh
Y2ggKCBxeHtwNCBAUDRBUkdTIC1jICRQNENMSUVOVCAtSCAkUDRIT1NUIC1kICRQNFJPT1QgaGF2
ZX0gKSB7DQogICAgbmV4dCBpZiAhbSFeKC8vLio/WyNdXGQrKSAtICguKikhbzsNCiAgICBteSAk
YSA9ICQxOw0KICAgIG15IEBiID0gc3BsaXQoL1tcL1xcXSsvLCAkMik7DQogICAgZm9yZWFjaCBt
eSAkZCAoQHJvb3QpIHsgIyByZW1vdmUgcm9vdA0KICAgICAgICBsYXN0IGlmICRkIG5lICRiWzBd
Ow0KICAgICAgICBzaGlmdCBAYjsNCiAgICB9DQogICAgc2hpZnQgQGIgd2hpbGUgJGJbMF0gZXEg
Jy4nOw0KICAgIG15ICRiID0gam9pbignLycsQGIpOw0KICAgIG15ICRibGMgPSBsYyAkYjsNCg0K
ICAgIGlmICggJF5PIGVxICdNU1dpbjMyJyApIHsgIyBzdHVwaWQgd2luZG93cywgZGFmdCBhY3Rp
dmVzdGF0ZQ0KCWlmICghZXhpc3RzKCRwNF9hX2xjeyRibGN9KSkgew0KCSAgICAkcDRfYV9sY3sk
YmxjfSA9IFskYSwgJGJdOw0KCX0gZWxzZSB7DQoJICAgIHdhcm4oIndhcm5pbmc6ICRhIC0+ICRi
XG4iLg0KCQkgIndhcm5pbmc6IGNvbmZsaWN0cyB3aXRoICIuDQoJCSAkcDRfYV9sY3skYmxjfS0+
WzBdLiIgLT4gIi4NCgkJICRwNF9hX2xjeyRibGN9LT5bMV0uIlxuIik7DQoJICAgICRBVVRPX0NP
TU1JVCA9IDA7DQoJICAgICRDb25mbGljdHMrKzsNCgkgICAgbmV4dDsNCgl9DQogICAgfQ0KDQog
ICAgbXkgJGk7DQogICAgZm9yICgkaSA9IDA7ICRpIDwgJCNiOyArKyRpKSB7DQoJbXkgJGJkaXIg
PSBqb2luKCcvJyxAYlswIC4uICRpXSkgLiAnLyc7DQoJaWYgKCAhZXhpc3RzKCRnaXRpZ25vcmVf
ZGlyc3skYmRpcn0pICkgew0KCSAgICAkZ2l0aWdub3JlX2RpcnN7JGJkaXJ9ID0gcmVhZF9maWx0
ZXJfZmlsZSgiJGJkaXIuZ2l0aWdub3JlIik7DQoJfQ0KICAgIH0NCiAgICBpZiAoZmlsdGVyZWQo
JGIpKSB7DQoJcHJpbnQgImlnbiAkYlxuIiBpZiAkVkVSQk9TRTsNCgkkSWdub3JlZCsrOw0KCW5l
eHQNCiAgICB9DQogICAgJHA0X2luZGV4eyRifSA9ICRhOw0KICAgIGlmICggZXhpc3RzKCRnaXRf
aW5kZXh7JGJ9KSApIHsgJFVwZGF0ZWQrKzsgcHVzaChAZ2l0X3VwZCwgJGIpIH0NCiAgICBlbHNl
IHsgJEFkZGVkKys7IHB1c2goQGdpdF9hZGQsICRiKSB9DQp9DQp1bmRlZiAlcDRfYV9sYzsNCg0K
QGdpdF9kZWwgPSBncmVwIHsgIWV4aXN0cygkcDRfaW5kZXh7JF99KSB9IGtleXMgJWdpdF9pbmRl
eDsNCiREZWxldGVkID0gJCNnaXRfZGVsICsgMTsNCg0KaWYgKCAkRFJZUlVOICkgew0KICAgIHBy
aW50IG1hcCB7ImFkZCAkX1xuIn0gQGdpdF9hZGQ7DQogICAgcHJpbnQgbWFwIHsiZGVsICRfXG4i
fSBAZ2l0X2RlbDsNCiAgICBwcmludCBtYXAgeyJ1cGQgJF9cbiJ9IEBnaXRfdXBkOw0KfSBlbHNl
IHsNCiAgICBwcmludCAiZ2l0IHVwZGF0ZS1pbmRleCAtLWFkZCAtLWNobW9kPS14IC16IC0tc3Rk
aW5cbiIgaWYgJFZFUkJPU0U7DQogICAgb3BlbihHSVQsICd8IGdpdCB1cGRhdGUtaW5kZXggLS1h
ZGQgLS1jaG1vZD0teCAteiAtLXN0ZGluJykgb3INCiAgICAgICAgZGllICIkMCBnaXQtdXBkYXRl
LWluZGV4KGFkZCk6ICQhXG4iOw0KICAgIHByaW50IEdJVCBtYXAge3ByaW50ICIgICRfXG4iIGlm
ICRWRVJCT1NFOyAiJF9cMCJ9IEBnaXRfYWRkOw0KICAgIGNsb3NlKEdJVCk7DQogICAgcHJpbnQg
ImdpdCB1cGRhdGUtaW5kZXggLS1mb3JjZS1yZW1vdmUgLXogLS1zdGRpblxuIiBpZiAkVkVSQk9T
RTsNCiAgICBvcGVuKEdJVCwgJ3wgZ2l0IHVwZGF0ZS1pbmRleCAtLWZvcmNlLXJlbW92ZSAteiAt
LXN0ZGluJykgb3INCiAgICAgICAgZGllICIkMCBnaXQtdXBkYXRlLWluZGV4KGRlbCk6ICQhXG4i
Ow0KICAgIHByaW50IEdJVCBtYXAge3ByaW50ICIgICRfXG4iIGlmICRWRVJCT1NFOyAiJF9cMCJ9
IEBnaXRfZGVsOw0KICAgIGNsb3NlKEdJVCk7DQogICAgcHJpbnQgImdpdCB1cGRhdGUtaW5kZXgg
LXogLS1zdGRpblxuIiBpZiAkVkVSQk9TRTsNCiAgICBvcGVuKEdJVCwgJ3wgZ2l0IHVwZGF0ZS1p
bmRleCAteiAtLXN0ZGluJykgb3INCiAgICAgICAgZGllICIkMCBnaXQtdXBkYXRlLWluZGV4KHVw
ZCk6ICQhXG4iOw0KICAgIHByaW50IEdJVCBtYXAge3ByaW50ICIgICRfXG4iIGlmICRWRVJCT1NF
OyAiJF9cMCJ9IEBnaXRfdXBkOw0KICAgIGNsb3NlKEdJVCk7DQp9DQpwcmludCAidXBkYXRlZDog
JFVwZGF0ZWQsIGFkZGVkOiAkQWRkZWQsIGRlbGV0ZWQ6ICREZWxldGVkLCAiIC4NCiAgICAgICJp
Z25vcmVkOiAkSWdub3JlZCwgY29uZmxpY3RzOiAkQ29uZmxpY3RzXG4iOw0KDQpleGl0IDA7DQoN
CnN1YiBmaWx0ZXJlZCB7DQogICAgbXkgJG5hbWUgPSBzaGlmdDsNCiAgICBzdHVkeSgkbmFtZSk7
DQogICAgbXkgQHBhdGggPSBzcGxpdCgvXC8rL28sICRuYW1lKTsNCiAgICBteSAkZGlyID0gJyc7
DQogICAgJG5hbWUgPSAnJzsNCiAgICANCiAgICBmb3JlYWNoIG15ICRkIChAcGF0aCkgew0KCSRu
YW1lIC49ICRkOw0KCWZvcmVhY2ggbXkgJHJlIChAeyRnaXRpZ25vcmVfZGlyc3snLyd9fSkgew0K
CSAgICByZXR1cm4gMSBpZiAkbmFtZSA9fiBtLyRyZS87DQoJICAgIHJldHVybiAxIGlmICRkID1+
IG0vJHJlLzsNCgl9DQoJaWYgKCBsZW5ndGgoJGRpcikgKSB7DQoJICAgIGZvcmVhY2ggbXkgJHJl
IChAeyRnaXRpZ25vcmVfZGlyc3skZGlyfX0pIHsNCgkJcmV0dXJuIDEgaWYgJG5hbWUgPX4gbS8k
cmUvOw0KCQlyZXR1cm4gMSBpZiAkZCA9fiBtLyRyZS87DQoJICAgIH0NCgl9DQoJJG5hbWUgLj0g
Jy8nOw0KCSRkaXIgPSAkbmFtZTsNCiAgICB9DQogICAgcmV0dXJuIDA7DQp9DQoNCnN1YiByZWFk
X2ZpbHRlcl9maWxlIHsNCiAgICBteSBAZmlsdHMgPSAoKTsNCiAgICBteSAkZmlsZSA9IHNoaWZ0
Ow0KICAgIGlmICggb3BlbihGLCAnPCcsICRmaWxlKSApIHsNCgkkLyA9ICJcbiI7DQoJd2hpbGUg
KG15ICRsID0gPEY+KSB7DQoJICAgIG5leHQgaWYgJGwgPX4gL15ccyojL287DQoJICAgIG5leHQg
aWYgJGwgPX4gL15ccyokL287DQoJICAgICRsID1+IHMvW1xyXG5dKyQvL3NvOw0KCSAgICAkbCA9
fiBzL1wuL1xcLi9nbzsNCgkgICAgJGwgPX4gcy9cKi8uKj8vZ287DQoJICAgIGlmICggJGwgPX4g
bS9cLy8gKSB7DQoJCXB1c2goQGZpbHRzLCBxci9eJGwoJHxcLykvKTsNCgkgICAgfSBlbHNlIHsN
CgkJcHVzaChAZmlsdHMsIHFyLyhefFwvKSRsJC8pOw0KCSAgICB9DQoJfQ0KCWNsb3NlKEYpOw0K
ICAgIH0NCiAgICByZXR1cm4gXEBmaWx0czsNCn0NCg0K
------=_Part_138486_22092783.1155560697217
Content-Type: application/octet-stream; name=git-p4-import.windows-bat
Content-Transfer-Encoding: base64
X-Attachment-Id: f_equuzud6
Content-Disposition: attachment; filename="git-p4-import.windows-bat"

QHJlbSA9ICdOVDogQ01ELkVYRSB2aW06IHN5bnRheD1wZXJsIG5vZXQgc3c9NA0KQHBlcmwgLXgg
LXMgJTAgLS0gJSoNCkBleGl0DQpAcmVtICc7DQojIXBlcmwgLXcNCiNsaW5lIDcNCg0KbG9jYWwg
JFZFUkJPU0UgPSAwOw0KbG9jYWwgJERSWVJVTiA9IDA7DQpsb2NhbCAkWUVTID0gMDsNCmxvY2Fs
ICRBVVRPX0NPTU1JVCA9IDE7DQpsb2NhbCAkTk9QNF9DTElFTlQgPSB1bmRlZjsNCmxvY2FsIEBQ
NEFSR1MgPSAoKTsNCnB1c2goQFA0QVJHUywgJy1QJywgJEVOVntQNFBBU1NXRH0pDQogICAgaWYg
ZGVmaW5lZCgkRU5We1A0UEFTU1dEfSkgYW5kIGxlbmd0aCgkRU5We1A0UEFTU1dEfSk7DQpsb2Nh
bCAkZWRpdG9yID0gJEVOVntWSVNVQUx9Ow0KJGVkaXRvciA9ICRFTlZ7RURJVE9SfSB1bmxlc3Mg
ZGVmaW5lZCgkZWRpdG9yKTsNCmRpZSAiJDA6IG5vIGVkaXRvciBkZWZpbmVkXG4iIHVubGVzcyBk
ZWZpbmVkKCRlZGl0b3IpOw0KDQpzdWIgcmVhZF9hcmdzIHsNCiAgICBteSAoJGluX2NsaWVudCkg
PSAoMCk7DQogICAgZm9yZWFjaCBteSAkZiAoIEBfICkgew0KCWlmICggJGluX2NsaWVudCApIHsg
JGluX2NsaWVudCA9IDA7ICROT1A0X0NMSUVOVCA9ICRmOyBuZXh0IH0NCgkkRFJZUlVOPTEsIG5l
eHQgaWYgJGYgZXEgJy1uJyBvciAkZiBlcSAnLS1kcnktcnVuJzsNCgkkWUVTPTEsIG5leHQgaWYg
JGYgZXEgJy15JyBvciAkZiBlcSAnLS15ZXMnOw0KCSRWRVJCT1NFPTEsIG5leHQgaWYgJGYgZXEg
Jy12JyBvciAkZiBlcSAnLS12ZXJib3NlJzsNCgkkaW5fY2xpZW50ID0gMSwgbmV4dCBpZiAkZiBl
cSAnLWMnOw0KICAgIH0NCn0NCnJlYWRfYXJncyhAQVJHVik7DQoNCmRpZSAiJDA6IFA0IGNsaWVu
dCBub3QgZGVmaW5lZFxuIiB1bmxlc3MgZGVmaW5lZCgkTk9QNF9DTElFTlQpOw0KbG9jYWwgKCRQ
NFJPT1QsICRQNENMSUVOVCwgJFA0SE9TVCk7DQpteSBAc3BlYyA9IGdyZXAgew0KICAgIGlmICgg
bS9eXHMqUm9vdDpccyooXFMrKVtcXFwvXSpccyokL3NvICkgeyAkUDRST09UID0gJDE7IDEgfQ0K
ICAgIGVsc2lmICggbS9eXHMqQ2xpZW50OlxzKihcUyspL28gKSB7ICRQNENMSUVOVCA9ICQxOyAx
IH0NCiAgICBlbHNpZiAoIG0vXlxzKkhvc3Q6XHMqKFxTKykvbyApIHsgJFA0SE9TVCA9ICQxOyAx
IH0NCiAgICBlbHNlIHsgMCB9DQp9IHF4e3A0IEBQNEFSR1MgY2xpZW50IC1vICROT1A0X0NMSUVO
VH07DQoNCmxvY2FsICgkR0lUX0RJUik9cXh7Z2l0IHJldi1wYXJzZSAtLWdpdC1kaXJ9Ow0KY2hv
bXAoJEdJVF9ESVIpOw0KZGllICIkMDogJEdJVF9ESVIgaXMgbm90IGdpdCBkaXJlY3RvcnlcbiIg
dW5sZXNzIC1kICRHSVRfRElSOw0KDQokLyA9ICJcMCI7DQpteSAlZ2l0X2luZGV4ID0gKCk7DQpm
b3JlYWNoICggcXh7Z2l0IGxzLWZpbGVzIC0tY2FjaGVkIC16fSApIHsNCiAgICBjaG9wOw0KICAg
IG5leHQgaWYgbS9eXC4ocDRzbXxub3A0KVwvL287DQogICAgbmV4dCBpZiBtL15cLmdpdGlnbm9y
ZSQvbzsNCiAgICBuZXh0IGlmIG0vXC9cLmdpdGlnbm9yZSQvbzsNCiAgICAkZ2l0X2luZGV4eyRf
fSA9IDE7DQp9DQoNCm15IEBnaXRfYWRkID0gKCk7DQpteSBAZ2l0X2RlbCA9ICgpOw0KbXkgQGdp
dF91cGQgPSAoKTsNCg0KbG9jYWwgJWdpdGlnbm9yZV9kaXJzID0gKCk7DQokZ2l0aWdub3JlX2Rp
cnN7Jy8nfSA9IHJlYWRfZmlsdGVyX2ZpbGUoIiRHSVRfRElSL2luZm8vZXhjbHVkZSIpOw0KcHVz
aChAeyRnaXRpZ25vcmVfZGlyc3snLyd9fSwgQHtyZWFkX2ZpbHRlcl9maWxlKCcuZ2l0aWdub3Jl
Jyl9KTsNCg0KIyBzdGF0cw0KbG9jYWwgKCRDb25mbGljdHMsJElnbm9yZWQsJEFkZGVkLCREZWxl
dGVkLCRVcGRhdGVkKSA9ICgwLDAsMCwwLDApOw0KJC8gPSAiXG4iOw0KbXkgJGluX25hbWUgPSAw
Ow0KbXkgQHJvb3QgPSBzcGxpdCgvW1wvXFxdKy8sICRQNFJPT1QpOw0KbXkgJXA0X2luZGV4ID0g
KCk7DQpteSAlcDRfYV9sYyA9ICgpOw0KZm9yZWFjaCAoIHF4e3A0IEBQNEFSR1MgLWMgJFA0Q0xJ
RU5UIC1IICRQNEhPU1QgLWQgJFA0Uk9PVCBoYXZlfSApIHsNCiAgICBuZXh0IGlmICFtIV4oLy8u
Kj9bI11cZCspIC0gKC4qKSFvOw0KICAgIG15ICRhID0gJDE7DQogICAgbXkgQGIgPSBzcGxpdCgv
W1wvXFxdKy8sICQyKTsNCiAgICBmb3JlYWNoIG15ICRkIChAcm9vdCkgeyAjIHJlbW92ZSByb290
DQogICAgICAgIGxhc3QgaWYgJGQgbmUgJGJbMF07DQogICAgICAgIHNoaWZ0IEBiOw0KICAgIH0N
CiAgICBzaGlmdCBAYiB3aGlsZSAkYlswXSBlcSAnLic7DQogICAgbXkgJGIgPSBqb2luKCcvJyxA
Yik7DQogICAgbXkgJGJsYyA9IGxjICRiOw0KDQogICAgaWYgKCAkXk8gZXEgJ01TV2luMzInICkg
eyAjIHN0dXBpZCB3aW5kb3dzLCBkYWZ0IGFjdGl2ZXN0YXRlDQoJaWYgKCFleGlzdHMoJHA0X2Ff
bGN7JGJsY30pKSB7DQoJICAgICRwNF9hX2xjeyRibGN9ID0gWyRhLCAkYl07DQoJfSBlbHNlIHsN
CgkgICAgd2Fybigid2FybmluZzogJGEgLT4gJGJcbiIuDQoJCSAid2FybmluZzogY29uZmxpY3Rz
IHdpdGggIi4NCgkJICRwNF9hX2xjeyRibGN9LT5bMF0uIiAtPiAiLg0KCQkgJHA0X2FfbGN7JGJs
Y30tPlsxXS4iXG4iKTsNCgkgICAgJEFVVE9fQ09NTUlUID0gMDsNCgkgICAgJENvbmZsaWN0cysr
Ow0KCSAgICBuZXh0Ow0KCX0NCiAgICB9DQoNCiAgICBteSAkaTsNCiAgICBmb3IgKCRpID0gMDsg
JGkgPCAkI2I7ICsrJGkpIHsNCglteSAkYmRpciA9IGpvaW4oJy8nLEBiWzAgLi4gJGldKSAuICcv
JzsNCglpZiAoICFleGlzdHMoJGdpdGlnbm9yZV9kaXJzeyRiZGlyfSkgKSB7DQoJICAgICRnaXRp
Z25vcmVfZGlyc3skYmRpcn0gPSByZWFkX2ZpbHRlcl9maWxlKCIkYmRpci5naXRpZ25vcmUiKTsN
Cgl9DQogICAgfQ0KICAgIGlmIChmaWx0ZXJlZCgkYikpIHsNCglwcmludCAiaWduICRiXG4iIGlm
ICRWRVJCT1NFOw0KCSRJZ25vcmVkKys7DQoJbmV4dA0KICAgIH0NCiAgICAkcDRfaW5kZXh7JGJ9
ID0gJGE7DQogICAgaWYgKCBleGlzdHMoJGdpdF9pbmRleHskYn0pICkgeyAkVXBkYXRlZCsrOyBw
dXNoKEBnaXRfdXBkLCAkYikgfQ0KICAgIGVsc2UgeyAkQWRkZWQrKzsgcHVzaChAZ2l0X2FkZCwg
JGIpIH0NCn0NCnVuZGVmICVwNF9hX2xjOw0KDQpAZ2l0X2RlbCA9IGdyZXAgeyAhZXhpc3RzKCRw
NF9pbmRleHskX30pIH0ga2V5cyAlZ2l0X2luZGV4Ow0KJERlbGV0ZWQgPSAkI2dpdF9kZWwgKyAx
Ow0KDQppZiAoICREUllSVU4gKSB7DQogICAgcHJpbnQgbWFwIHsiYWRkICRfXG4ifSBAZ2l0X2Fk
ZDsNCiAgICBwcmludCBtYXAgeyJkZWwgJF9cbiJ9IEBnaXRfZGVsOw0KICAgIHByaW50IG1hcCB7
InVwZCAkX1xuIn0gQGdpdF91cGQ7DQp9IGVsc2Ugew0KICAgIHByaW50ICJnaXQgdXBkYXRlLWlu
ZGV4IC0tYWRkIC0tY2htb2Q9LXggLXogLS1zdGRpblxuIiBpZiAkVkVSQk9TRTsNCiAgICBvcGVu
KEdJVCwgJ3wgZ2l0IHVwZGF0ZS1pbmRleCAtLWFkZCAtLWNobW9kPS14IC16IC0tc3RkaW4nKSBv
cg0KICAgICAgICBkaWUgIiQwIGdpdC11cGRhdGUtaW5kZXgoYWRkKTogJCFcbiI7DQogICAgcHJp
bnQgR0lUIG1hcCB7cHJpbnQgIiAgJF9cbiIgaWYgJFZFUkJPU0U7ICIkX1wwIn0gQGdpdF9hZGQ7
DQogICAgY2xvc2UoR0lUKTsNCiAgICBwcmludCAiZ2l0IHVwZGF0ZS1pbmRleCAtLWZvcmNlLXJl
bW92ZSAteiAtLXN0ZGluXG4iIGlmICRWRVJCT1NFOw0KICAgIG9wZW4oR0lULCAnfCBnaXQgdXBk
YXRlLWluZGV4IC0tZm9yY2UtcmVtb3ZlIC16IC0tc3RkaW4nKSBvcg0KICAgICAgICBkaWUgIiQw
IGdpdC11cGRhdGUtaW5kZXgoZGVsKTogJCFcbiI7DQogICAgcHJpbnQgR0lUIG1hcCB7cHJpbnQg
IiAgJF9cbiIgaWYgJFZFUkJPU0U7ICIkX1wwIn0gQGdpdF9kZWw7DQogICAgY2xvc2UoR0lUKTsN
CiAgICBwcmludCAiZ2l0IHVwZGF0ZS1pbmRleCAteiAtLXN0ZGluXG4iIGlmICRWRVJCT1NFOw0K
ICAgIG9wZW4oR0lULCAnfCBnaXQgdXBkYXRlLWluZGV4IC16IC0tc3RkaW4nKSBvcg0KICAgICAg
ICBkaWUgIiQwIGdpdC11cGRhdGUtaW5kZXgodXBkKTogJCFcbiI7DQogICAgcHJpbnQgR0lUIG1h
cCB7cHJpbnQgIiAgJF9cbiIgaWYgJFZFUkJPU0U7ICIkX1wwIn0gQGdpdF91cGQ7DQogICAgY2xv
c2UoR0lUKTsNCn0NCnByaW50ICJ1cGRhdGVkOiAkVXBkYXRlZCwgYWRkZWQ6ICRBZGRlZCwgZGVs
ZXRlZDogJERlbGV0ZWQsICIgLg0KICAgICAgImlnbm9yZWQ6ICRJZ25vcmVkLCBjb25mbGljdHM6
ICRDb25mbGljdHNcbiI7DQoNCmV4aXQgMDsNCg0Kc3ViIGZpbHRlcmVkIHsNCiAgICBteSAkbmFt
ZSA9IHNoaWZ0Ow0KICAgIHN0dWR5KCRuYW1lKTsNCiAgICBteSBAcGF0aCA9IHNwbGl0KC9cLysv
bywgJG5hbWUpOw0KICAgIG15ICRkaXIgPSAnJzsNCiAgICAkbmFtZSA9ICcnOw0KICAgIA0KICAg
IGZvcmVhY2ggbXkgJGQgKEBwYXRoKSB7DQoJJG5hbWUgLj0gJGQ7DQoJZm9yZWFjaCBteSAkcmUg
KEB7JGdpdGlnbm9yZV9kaXJzeycvJ319KSB7DQoJICAgIHJldHVybiAxIGlmICRuYW1lID1+IG0v
JHJlLzsNCgkgICAgcmV0dXJuIDEgaWYgJGQgPX4gbS8kcmUvOw0KCX0NCglpZiAoIGxlbmd0aCgk
ZGlyKSApIHsNCgkgICAgZm9yZWFjaCBteSAkcmUgKEB7JGdpdGlnbm9yZV9kaXJzeyRkaXJ9fSkg
ew0KCQlyZXR1cm4gMSBpZiAkbmFtZSA9fiBtLyRyZS87DQoJCXJldHVybiAxIGlmICRkID1+IG0v
JHJlLzsNCgkgICAgfQ0KCX0NCgkkbmFtZSAuPSAnLyc7DQoJJGRpciA9ICRuYW1lOw0KICAgIH0N
CiAgICByZXR1cm4gMDsNCn0NCg0Kc3ViIHJlYWRfZmlsdGVyX2ZpbGUgew0KICAgIG15IEBmaWx0
cyA9ICgpOw0KICAgIG15ICRmaWxlID0gc2hpZnQ7DQogICAgaWYgKCBvcGVuKEYsICc8JywgJGZp
bGUpICkgew0KCSQvID0gIlxuIjsNCgl3aGlsZSAobXkgJGwgPSA8Rj4pIHsNCgkgICAgbmV4dCBp
ZiAkbCA9fiAvXlxzKiMvbzsNCgkgICAgbmV4dCBpZiAkbCA9fiAvXlxzKiQvbzsNCgkgICAgJGwg
PX4gcy9bXHJcbl0rJC8vc287DQoJICAgICRsID1+IHMvXC4vXFwuL2dvOw0KCSAgICAkbCA9fiBz
L1wqLy4qPy9nbzsNCgkgICAgaWYgKCAkbCA9fiBtL1wvLyApIHsNCgkJcHVzaChAZmlsdHMsIHFy
L14kbCgkfFwvKS8pOw0KCSAgICB9IGVsc2Ugew0KCQlwdXNoKEBmaWx0cywgcXIvKF58XC8pJGwk
Lyk7DQoJICAgIH0NCgl9DQoJY2xvc2UoRik7DQogICAgfQ0KICAgIHJldHVybiBcQGZpbHRzOw0K
fQ0KDQo=
------=_Part_138486_22092783.1155560697217--
