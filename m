From: David Bremner <bremner@unb.ca>
Subject: Re: Commit f5bbc322 to git broke pre-commit hooks which read stdin
Date: Tue, 04 Mar 2008 12:48:38 +0100
Message-ID: <0t4pbmaew9.wl%bremner@pivot.cs.unb.ca>
References: <0tableanpe.wl%bremner@pivot.cs.unb.ca>
	<alpine.LSU.1.00.0803041044120.22527@racer.site>
	<7vk5ki91zj.fsf@gitster.siamese.dyndns.org>
Reply-To: David Bremner <bremner@unb.ca>
Mime-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Cc: Johannes Schindelin <Johannes.Schindelin@gmx.de>,
	Kristian =?ISO-8859-1?Q?H=F8gsberg?= <krh@redhat.com>,
	git@vger.kernel.org
To: Junio C Hamano <gitster@pobox.com>
X-From: git-owner@vger.kernel.org Tue Mar 04 13:17:51 2008
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git-2@gmane.org
Received: from vger.kernel.org ([209.132.176.167])
	by lo.gmane.org with esmtp (Exim 4.50)
	id 1JWW5Y-0007lr-Cw
	for gcvg-git-2@gmane.org; Tue, 04 Mar 2008 13:17:44 +0100
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1753357AbYCDMRH (ORCPT <rfc822;gcvg-git-2@m.gmane.org>);
	Tue, 4 Mar 2008 07:17:07 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1752942AbYCDMRG
	(ORCPT <rfc822;git-outgoing>); Tue, 4 Mar 2008 07:17:06 -0500
Received: from pivot.cs.unb.ca ([131.202.240.57]:38121 "EHLO pivot.cs.unb.ca"
	rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
	id S1752768AbYCDMRF (ORCPT <rfc822;git@vger.kernel.org>);
	Tue, 4 Mar 2008 07:17:05 -0500
X-Greylist: delayed 1701 seconds by postgrey-1.27 at vger.kernel.org; Tue, 04 Mar 2008 07:17:05 EST
Received: from bremner by pivot.cs.unb.ca with local (Exim 4.68)
	(envelope-from <bremner-dated-1205840921.47f296@pivot.cs.unb.ca>)
	id 1JWVdR-0005j2-Os
	for git@vger.kernel.org; Tue, 04 Mar 2008 07:48:41 -0400
Received: by pivot.cs.unb.ca (tmda-sendmail, from uid 1266);
	Tue, 04 Mar 2008 07:48:40 -0400
Received: from bremner (helo=pivot.cs.unb.ca)
	by pivot.cs.unb.ca with local-esmtp (Exim 4.68)
	(envelope-from <bremner@pivot.cs.unb.ca>)
	id 1JWVdP-0005ij-RB; Tue, 04 Mar 2008 07:48:40 -0400
In-Reply-To: <7vk5ki91zj.fsf@gitster.siamese.dyndns.org>
User-Agent: SEMI/1.14.6 (Maruoka) FLIM/1.14.9 (=?ISO-8859-4?Q?Goj=F2?=)
	APEL/10.7 Emacs/22.1 (i486-pc-linux-gnu) MULE/5.0 (SAKAKI)
X-Delivery-Agent: TMDA/1.1.11 (Ladyburn)
X-TMDA-Fingerprint: kZx2/x3GzbjqCpiMKy/LMtPgJoU
X-Primary-Address: bremner@unb.ca
Sender: git-owner@vger.kernel.org
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/76078>

>>>>> "Junio" == Junio C Hamano <gitster@pobox.com> writes:

    Junio> Johannes Schindelin <Johannes.Schindelin@gmx.de> writes:

    >> Pardon my ignorance, but what business has metastore reading
    >> stdin?  There should be nothing coming in, so the change you
    >> mentioned should be correct, and your hook relies on something
    >> it should not rely on.

    Junio> It is not metastore.  It is an interactive hook that reads
    Junio> from the user who is sitting on the terminal and invoked
    Junio> the git-commit program.

Yeah, I should have been more explicit. The problem is a line 

      read -N1 VAR

This used to work, and now it doesn't.  Maybe there are good reasons
for change in git, I don't know. I'm just reporting that something
broke. And asking nicely that what hooks can and can not depend on be
documented somewhere to avoid future problems of this type.

All the best,

David

P.S. I removed 469250@bugs.debian.org  from CC; I'm not sure Debian BTS needs all of the discussion.
Feel free to put it back if you disagree. 


