From: Carl Worth <cworth@cworth.org>
Subject: Re: Separating "add path to index" from "update content in index"
Date: Fri, 22 Dec 2006 08:18:23 -0800
Message-ID: <87bqlvj44w.wl%cworth@cworth.org>
References: <89b129c60612191233s5a7f36f2hd409c4b9a2bbbc5c@mail.gmail.com>
	<7v64c7pmlw.fsf@assigned-by-dhcp.cox.net>
	<87wt4m2o99.wl%cworth@cworth.org>
	<7vmz5i6vqb.fsf@assigned-by-dhcp.cox.net>
	<87vek62n1k.wl%cworth@cworth.org>
	<7v1wmu5ecs.fsf@assigned-by-dhcp.cox.net>
	<87tzzp3fgh.wl%cworth@cworth.org>
	<slrneokplo.nsf.Peter.B.Baumann@xp.machine.xx>
	<7vbqlw92fw.fsf@assigned-by-dhcp.cox.net>
	<87d56cirs8.wl%cworth@cworth.org>
	<7vfyb87bxg.fsf@assigned-by-dhcp.cox.net>
Mime-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: multipart/signed;
 boundary="pgp-sign-Multipart_Fri_Dec_22_08:18:12_2006-1"; micalg=pgp-sha1;
 protocol="application/pgp-signature"
Content-Transfer-Encoding: 7bit
Cc: Peter Baumann <Peter.B.Baumann@stud.informatik.uni-erlangen.de>,
	git@vger.kernel.org
X-From: git-owner@vger.kernel.org Fri Dec 22 17:20:14 2006
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git@gmane.org
Received: from vger.kernel.org ([209.132.176.167])
	by dough.gmane.org with esmtp (Exim 4.50)
	id 1Gxn7v-0006U6-I9
	for gcvg-git@gmane.org; Fri, 22 Dec 2006 17:20:07 +0100
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1750752AbWLVQTw (ORCPT <rfc822;gcvg-git@m.gmane.org>);
	Fri, 22 Dec 2006 11:19:52 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1750770AbWLVQTw
	(ORCPT <rfc822;git-outgoing>); Fri, 22 Dec 2006 11:19:52 -0500
Received: from cworth.org ([217.160.249.188]:48609 "EHLO theworths.org"
	rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
	id S1750752AbWLVQTv (ORCPT <rfc822;git@vger.kernel.org>);
	Fri, 22 Dec 2006 11:19:51 -0500
Received: (qmail 10001 invoked from network); 22 Dec 2006 11:19:49 -0500
Received: from localhost (HELO raht.cworth.org) (127.0.0.1)
  by localhost with SMTP; 22 Dec 2006 11:19:49 -0500
To: Junio C Hamano <junkio@cox.net>
In-Reply-To: <7vfyb87bxg.fsf@assigned-by-dhcp.cox.net>
User-Agent: Wanderlust/2.14.0 (Africa) Emacs/21.4 Mule/5.0 (SAKAKI)
Sender: git-owner@vger.kernel.org
Precedence: bulk
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/35185>

--pgp-sign-Multipart_Fri_Dec_22_08:18:12_2006-1
Content-Type: text/plain; charset=US-ASCII

At Thu, 21 Dec 2006 21:10:51 -0800, Junio C Hamano wrote:
> I guess my responding to whatever you said was wasted effort,
> and if you do not like "git add" this time, I should not be
> surprised.  That's kind of sad ;-).

I hope I'm not coming across as always just complaining. I do think
the new "git add" thing is an improvement. So if nothing else changes,
I still think git's better than it was before this recent round of
improvements.

> I do not remember who advocated for making "git status" the
> preview of "git commit" to happen.  Was that also you?  I wonder
> how many people use this form:
>
> 	git status -v path1 path2...

I was involved in the discussions that led to "status -v", yes. As a
new user I was surprised that "git diff" didn't give a commit preview
and you replied with the "status -v" idea. As things have turned out,
I've never used "status -v".

> Sure, what you want is "git add --no-add newfile", and I can
> understand that mode of operation if you are always going to
> commit with "git commit -a".  Maybe we can have a config
> variable that makes "commit -a" and "add --no-add" the default
> for these two commands, and we do not have to change anything
> else.

Yes, you could add the "don't update content" as an option to git-add,
and then all that would be left would be a discussion about which
modes get the default and which require configuration options, (and
those discussions generally don't go anywhere).

But don't you see how odd the command "git add --no-add" looks? What
does it mean to add something without adding it? This is just
reinforcing my position that using "add" to mean "update content"
rather muddles things.

> One minor detail I wonder about is what mode bits would you give
> to that placeholder entry.

You could certainly grab them from the named file if it exists. If the
user is going to "commit -a" it won't matter much, right?

> > I think the best would be:
> >
> > 	git update-index --all
> >
> > which would still allow room for:
> >
> > 	git add --all
>
> Wasn't it you who said "all" is ambiguous (all known to git vs
> all in this directory)?

Yes. Having "--all" is ambiguous while "git add" is used for both
adding new paths to the index _and_ updating index content. But if
"git add" were restricted to just adding paths to the index as I am
suggesting, then there's no ambiguity at all.

-Carl

--pgp-sign-Multipart_Fri_Dec_22_08:18:12_2006-1
Content-Type: application/pgp-signature
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)

iD8DBQBFjAVP6JDdNq8qSWgRAlMJAKCAKLGxWQ1Aedc/WDg/40nz2bbyjQCdGPxI
TjoTeYjMGu4o6TnPvXO8Lew=
=G2di
-----END PGP SIGNATURE-----

--pgp-sign-Multipart_Fri_Dec_22_08:18:12_2006-1--
