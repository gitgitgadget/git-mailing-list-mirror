From: Torsten =?utf-8?q?B=C3=B6gershausen?= <tboegi@web.de>
Subject: [PATCH] gitweb-lib.sh: Set up PATH to use perl from /usr/bin
Date: Tue, 1 May 2012 13:23:44 +0200
Message-ID: <201205011323.45190.tboegi@web.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: QUOTED-PRINTABLE
Cc: tboegi@web.de
To: jnareb@gmail.com, git@vger.kernel.org
X-From: git-owner@vger.kernel.org Tue May 01 13:32:01 2012
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git-2@plane.gmane.org
Received: from vger.kernel.org ([209.132.180.67])
	by plane.gmane.org with esmtp (Exim 4.69)
	(envelope-from <git-owner@vger.kernel.org>)
	id 1SPBJJ-0006qJ-Dl
	for gcvg-git-2@plane.gmane.org; Tue, 01 May 2012 13:32:01 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1755325Ab2EALbf convert rfc822-to-quoted-printable (ORCPT
	<rfc822;gcvg-git-2@m.gmane.org>); Tue, 1 May 2012 07:31:35 -0400
Received: from fmmailgate01.web.de ([217.72.192.221]:36709 "EHLO
	fmmailgate01.web.de" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1754975Ab2EALbe convert rfc822-to-8bit (ORCPT
	<rfc822;git@vger.kernel.org>); Tue, 1 May 2012 07:31:34 -0400
X-Greylist: delayed 465 seconds by postgrey-1.27 at vger.kernel.org; Tue, 01 May 2012 07:31:34 EDT
Received: from moweb001.kundenserver.de (moweb001.kundenserver.de [172.19.20.114])
	by fmmailgate01.web.de (Postfix) with ESMTP id A832A1AD4AAD3
	for <git@vger.kernel.org>; Tue,  1 May 2012 13:23:48 +0200 (CEST)
Received: from maxi.localnet ([194.22.188.61]) by smtp.web.de (mrweb002) with
 ESMTPA (Nemesis) id 0Ldmkd-1Rxqit1I5j-00j1Ts; Tue, 01 May 2012 13:23:48 +0200
X-Provags-ID: V02:K0:xLB67C5AK9ZAe6Ajjh8fVjkGoD7H7M5pPSCbvOMhW/i
 40osbIS5OIKDonH/Xhx14Q8fQ91dgCi/+tnL/e6rwhSYn/Y+HB
 qYinBUR7gKeLFPX++hcU3CQqlV/IBqie3T1rMjI3X6IsBxYgn3
 NOKK5UcY5A2IA6mnzD0a2BOKvniz32NIHRdj3AJ/OrQCM3ATsD
 3PbBdv4gqSPl/dVLiws9A==
Sender: git-owner@vger.kernel.org
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/196680>

When there are different version of perl installed on the machine,
the $PATH may point out a different version of perl than /usr/bin.
One example is to have /opt/local/bin/perl before /usr/bin/perl.

Sanitize the PATH by adding /usr/bin at the beginning

Signed-off-by: Torsten B=C3=B6gershausen <tboegi@web.de>
---
On my Mac OS machine t9501-gitweb-standalone-http-status.sh failed beca=
use
perl was found under /opt/local/bin instead of of /usr/bin.

/opt/local/bin is coming from Macports.
The problem with different perl installations on the same machine
may hit more people than just me.

There are different solutions, please help to find the best one:

a) Delete perl from /opt/local/bin
b) Put /opt/local/bin at the end of the PATH=20
c) Change gitweb-lib.sh to set up the PATH to /usr/bin, because that is=
 what the
file gitweb_config.perl generated by gitweb-lib.sh expects.


 t/gitweb-lib.sh |    3 +++
 1 file changed, 3 insertions(+)

diff --git a/t/gitweb-lib.sh b/t/gitweb-lib.sh
index 21d11d6..a016142 100644
--- a/t/gitweb-lib.sh
+++ b/t/gitweb-lib.sh
@@ -113,4 +113,7 @@ perl -MCGI -MCGI::Util -MCGI::Carp -e 0 >/dev/null =
2>&1 || {
 	test_done
 }
=20
+PATH=3D/usr/bin/:$PATH
+export PATH
+
 gitweb_init
--=20
1.7.10.rc0.17.g74595.dirty
