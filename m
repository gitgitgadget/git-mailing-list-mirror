From: Carl Worth <cworth@cworth.org>
Subject: Re: Updated Kernel Hacker's guide to git
Date: Fri, 22 Dec 2006 15:31:09 -0800
Message-ID: <8764c3ik3m.wl%cworth@cworth.org>
References: <38b2ab8a0612210424o4ec5fcd5kb5086c52ccd76491@mail.gmail.com>
	<Pine.LNX.4.64.0612211013500.3394@woody.osdl.org>
	<87slf83erg.wl%cworth@cworth.org>
	<Pine.LNX.4.64.0612212009370.3536@woody.osdl.org>
	<877iwjinda.wl%cworth@cworth.org>
	<7v7iwjwnwh.fsf@assigned-by-dhcp.cox.net>
Mime-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: multipart/signed;
 boundary="pgp-sign-Multipart_Fri_Dec_22_15:31:01_2006-1"; micalg=pgp-sha1;
 protocol="application/pgp-signature"
Content-Transfer-Encoding: 7bit
Cc: git@vger.kernel.org
X-From: git-owner@vger.kernel.org Sat Dec 23 00:32:58 2006
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git@gmane.org
Received: from vger.kernel.org ([209.132.176.167])
	by dough.gmane.org with esmtp (Exim 4.50)
	id 1Gxtsm-0002fx-1D
	for gcvg-git@gmane.org; Sat, 23 Dec 2006 00:32:56 +0100
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1753239AbWLVXcj (ORCPT <rfc822;gcvg-git@m.gmane.org>);
	Fri, 22 Dec 2006 18:32:39 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1753249AbWLVXcj
	(ORCPT <rfc822;git-outgoing>); Fri, 22 Dec 2006 18:32:39 -0500
Received: from cworth.org ([217.160.249.188]:51052 "EHLO theworths.org"
	rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
	id S1753239AbWLVXci (ORCPT <rfc822;git@vger.kernel.org>);
	Fri, 22 Dec 2006 18:32:38 -0500
Received: (qmail 1650 invoked from network); 22 Dec 2006 18:32:37 -0500
Received: from localhost (HELO raht.cworth.org) (127.0.0.1)
  by localhost with SMTP; 22 Dec 2006 18:32:37 -0500
To: Junio C Hamano <junkio@cox.net>
In-Reply-To: <7v7iwjwnwh.fsf@assigned-by-dhcp.cox.net>
User-Agent: Wanderlust/2.14.0 (Africa) Emacs/21.4 Mule/5.0 (SAKAKI)
Sender: git-owner@vger.kernel.org
Precedence: bulk
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/35245>

--pgp-sign-Multipart_Fri_Dec_22_15:31:01_2006-1
Content-Type: text/plain; charset=US-ASCII

On Fri, 22 Dec 2006 14:45:18 -0800, Junio C Hamano wrote:
> Exactly; diff just reuses the non-magic part of revision
> parameter parsing without using the ancestry traversal
> machinery (which is the magic part).

Thanks, that helps.

> It knows that rev-parse makes it "b a ^base", and it knows what
> the user meant is "base..b".

Ahah! So the "a...b" syntax is how to get at what:

	git diff $(git merge-base a b) b

would give. Thanks for explaining, since that was not at all obvious.

> That's all because we teach them to spell "a...b" when they want
> "base..b".  Similarly, because we allow them to spell "a..b"
> when they mean "between two points, a and b", it handles "b ^a"
> as the equivalent to giving two trees separately, as "a b".

Where is that teaching happening exactly? Both the "a..b" and "a...b"
forms seem to be entirely missing from the documentation of git
diff. :-)

> I do not think you are seriously saying that comparing A and
> B in this picture is meaningless:
>
>       o---o---B
>      /
>  ---M---o---A

No, I'm certainly not saying that that that comparison is meaningless.

All I was trying to say is that comparing M to B would be meaningful
too, and I hoped that git would provide good syntax for both. If I'm
understanding things correctly now, what exists is:

  git diff A B
  git diff A..B

	Compare A to B

  git diff A...B

	Compare M to B

So, at the beginning of this thread I wasn't aware that git provided
any short syntax for the "M to B" comparison, (the thread started with
suggestions for adding "git diff $(git merge-base A B) B" to the
hackers guide).

Now, I'm happy to know that git does provide a short syntax for that
useful operation.

My only comment now is that the distinction between ".." and "..." in
git-diff is quite surprising. In fact, in one sense it's exactly
opposite from the distinction of ".." and "..." as used in git log.

For example, given the above graph, "git diff A..B" shows changes due
to all 5 of commits on both branches while "git log -p A..B" shows
only the changes of the 3 commits from M to B.

Meanwhile, "git diff A...B" shows changes due to the 3 commits from M
to B while "git log -p A...B" shows the changes from all 5 of the
commits on both branches.

That's really surprising behavior (to me at least).

-Carl

--pgp-sign-Multipart_Fri_Dec_22_15:31:01_2006-1
Content-Type: application/pgp-signature
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)

iD8DBQBFjGq96JDdNq8qSWgRAnewAKCMwzn8csb2nZD2c5K6ZHxNnohGbACcC4CB
j49QDC7oAmKNObJDDkwqUKI=
=Fi48
-----END PGP SIGNATURE-----

--pgp-sign-Multipart_Fri_Dec_22_15:31:01_2006-1--
