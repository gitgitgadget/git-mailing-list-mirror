From: =?ISO-8859-1?Q?Ren=E9_Scharfe?= <rene.scharfe@lsrfire.ath.cx>
Subject: Re: Systems with non-posix TAR implementations: How to handle
Date: Mon, 26 Apr 2010 19:50:23 +0200
Message-ID: <4BD5D25F.904@lsrfire.ath.cx>
References: <s2sd2d39d861004260855l2ca5799fj7dfa70799ff1f307@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: QUOTED-PRINTABLE
Cc: git@vger.kernel.org
To: Tor Arntsen <tor@spacetec.no>
X-From: git-owner@vger.kernel.org Mon Apr 26 19:52:22 2010
connect(): No such file or directory
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git-2@lo.gmane.org
Received: from vger.kernel.org ([209.132.180.67])
	by lo.gmane.org with esmtp (Exim 4.69)
	(envelope-from <git-owner@vger.kernel.org>)
	id 1O6STl-0002Vq-Kn
	for gcvg-git-2@lo.gmane.org; Mon, 26 Apr 2010 19:52:22 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1753992Ab0DZRvB convert rfc822-to-quoted-printable (ORCPT
	<rfc822;gcvg-git-2@m.gmane.org>); Mon, 26 Apr 2010 13:51:01 -0400
Received: from india601.server4you.de ([85.25.151.105]:60340 "EHLO
	india601.server4you.de" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1753477Ab0DZRvA (ORCPT <rfc822;git@vger.kernel.org>);
	Mon, 26 Apr 2010 13:51:00 -0400
Received: from [10.0.1.100] (p57B7DC14.dip.t-dialin.net [87.183.220.20])
	by india601.server4you.de (Postfix) with ESMTPSA id 43B402F805B;
	Mon, 26 Apr 2010 19:50:58 +0200 (CEST)
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; de; rv:1.9.1.9) Gecko/20100317 Thunderbird/3.0.4
In-Reply-To: <s2sd2d39d861004260855l2ca5799fj7dfa70799ff1f307@mail.gmail.com>
Sender: git-owner@vger.kernel.org
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/145832>

Am 26.04.2010 17:55, schrieb Tor Arntsen:
> Ref. the testlog that I posted in the thread "[PATCH] Add Tru64/OSF1
> support in Makefile"
>=20
> *** t0024-crlf-archive.sh ***
> *   ok 1: setup
> * FAIL 2: tar archive
>=20
>=20
>                git archive --format=3Dtar HEAD |
>                ( mkdir untarred && cd untarred && "$TAR" -xf - )
>=20
>                test_cmp sample untarred/sample
>=20
>=20
>  *   ok 3: zip archive.
>=20
> The problem with that test is that the Tru64 V5.1 'tar' says 'This
> doesn't look like a tar archive' on the generated file. However, it
> turns out that the tar file generated by 'git archive --format=3Dtar'=
 is
> fine, it's just that it's a POSIX tar archive and the Tru64 'tar'
> program isn't POSIX tar format compatible.
> How should we handle this? Just ignore errors in this test on Tru64,
> or is there some other way that I missed?

That depends: if you just want to make sure that the test works fine,
you could install GNU tar, perhaps as gtar, and let TAR in Makefile (or
config.mak) point to it.  If the test fails with a tar that understands
the format then you've found a bug.

It could get a bit more complicated if you want to use git archive to
create tar files that the native tar can understand.  For most repos it
should be sufficient to specify a tree instead of a commit, e.g. with a=
n
added colon:

	git archive -o archive-without-comment.tar HEAD:

This makes git archive leave out the comment entry, which might upset
some tar implementations.  I don't know if that's sufficient to make
Tru64 tar happy, though.

Ren=E9
