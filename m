Return-Path: <git-owner@kernel.org>
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on
	aws-us-west-2-korg-lkml-1.web.codeaurora.org
X-Spam-Level: 
X-Spam-Status: No, score=-8.8 required=3.0 tests=BAYES_00,
	HEADER_FROM_DIFFERENT_DOMAINS,INCLUDES_PATCH,MAILING_LIST_MULTI,SPF_HELO_NONE,
	SPF_PASS autolearn=ham autolearn_force=no version=3.4.0
Received: from mail.kernel.org (mail.kernel.org [198.145.29.99])
	by smtp.lore.kernel.org (Postfix) with ESMTP id 6365FC433E0
	for <git@archiver.kernel.org>; Thu,  4 Mar 2021 06:14:49 +0000 (UTC)
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.kernel.org (Postfix) with ESMTP id 3650E64EF9
	for <git@archiver.kernel.org>; Thu,  4 Mar 2021 06:14:49 +0000 (UTC)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S234038AbhCDGOR (ORCPT <rfc822;git@archiver.kernel.org>);
        Thu, 4 Mar 2021 01:14:17 -0500
Received: from smtp32.hk.chengmail.me ([210.209.85.96]:49745 "EHLO
        smtp32.hk.chengmail.me" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S234536AbhCDGNq (ORCPT <rfc822;git@vger.kernel.org>);
        Thu, 4 Mar 2021 01:13:46 -0500
X-Greylist: delayed 1350 seconds by postgrey-1.27 at vger.kernel.org; Thu, 04 Mar 2021 01:13:46 EST
X-CHENGMAILHOST: 210.209.85.96
X-CHENGMAIL-INSTANCEID: 774f.60407523.1cffb.0
Date:   Thu, 4 Mar 2021 13:50:27 +0800
From:   "lilinchao@oschina.cn" <lilinchao@oschina.cn>
To:     "Junio C Hamano" <gitster@pobox.com>,
        "Li Linchao via GitGitGadget" <gitgitgadget@gmail.com>
Cc:     git <git@vger.kernel.org>, "Derrick Stolee" <stolee@gmail.com>,
        dscho <johannes.schindelin@gmx.de>
Subject: Re: Re: [PATCH v5] builtin/clone.c: add --reject-shallow option
References: <pull.865.v4.git.1613891147977.gitgitgadget@gmail.com>, 
        <pull.865.v5.git.1614535588332.gitgitgadget@gmail.com>, 
        <xmqq35xbj01p.fsf@gitster.c.googlers.com>
X-Priority: 3
X-Has-Attach: no
X-Mailer: Foxmail 7.2.19.158[cn]
Mime-Version: 1.0
X-source-message-id: <2021030413502665726717@oschina.cn>
Content-Type: text/plain;
        charset="utf-8"
Content-Transfer-Encoding: base64
Message-ID: <880ae0707cad11eb8ccc0024e87935e7@oschina.cn>
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org

PiJMaSBMaW5jaGFvIHZpYSBHaXRHaXRHYWRnZXQiIDxnaXRnaXRnYWRnZXRAZ21haWwuY29tPiB3
cml0ZXM6Cj4KPj4gZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vY29uZmlnL2Nsb25lLnR4dCBi
L0RvY3VtZW50YXRpb24vY29uZmlnL2Nsb25lLnR4dAo+PiBpbmRleCA0N2RlMzZhNWZlZGYuLjUw
ZWJjMTcwYmI4MSAxMDA2NDQKPj4gLS0tIGEvRG9jdW1lbnRhdGlvbi9jb25maWcvY2xvbmUudHh0
Cj4+ICsrKyBiL0RvY3VtZW50YXRpb24vY29uZmlnL2Nsb25lLnR4dAo+PiBAQCAtMiwzICsyLDcg
QEAgY2xvbmUuZGVmYXVsdFJlbW90ZU5hbWU6Ogo+PsKgIFRoZSBuYW1lIG9mIHRoZSByZW1vdGUg
dG8gY3JlYXRlIHdoZW4gY2xvbmluZyBhIHJlcG9zaXRvcnkuwqAgRGVmYXVsdHMgdG8KPj7CoCBg
b3JpZ2luYCwgYW5kIGNhbiBiZSBvdmVycmlkZGVuIGJ5IHBhc3NpbmcgdGhlIGAtLW9yaWdpbmAg
Y29tbWFuZC1saW5lCj4+wqAgb3B0aW9uIHRvIGxpbmtnaXQ6Z2l0LWNsb25lWzFdLgo+PiArCj4+
ICtjbG9uZS5yZWplY3RzaGFsbG93OjoKPj4gKwlSZWplY3QgdG8gY2xvbmUgYSByZXBvc2l0b3J5
IGlmIGl0IGlzIGEgc2hhbGxvdyBvbmUsIGNhbiBiZSBvdmVycmlkZGVuIGJ5Cj4+ICsJcGFzc2lu
ZyBvcHRpb24gYC0tcmVqZWN0LXNoYWxsb3dgIGluIGNvbW1hbmQgbGluZS4gU2VlIGxpbmtnaXQ6
Z2l0LWNsb25lWzFdCj4KPkxldCdzIGNhbWVsQ2FzZSB0aGlzLCBpLmUuICJjbG9uZS5yZWplY3RT
aGFsbG93IiwgYXMgdGhpcyBmaWxlIHdvdWxkCj5iZSBhIGdvb2QgY2FuZGlkYXRlIHRvIGJlIHRo
ZSBhdXRob3JpdGF0aXZlIHJlY29yZCBvZiBjYW5vbmljYWwKPnNwZWxsaW5nIG9mIHRoZXNlIHZh
cmlhYmxlcy4KPgo+Y2YuIGh0dHBzOi8vbG9yZS5rZXJuZWwub3JnL2dpdC94bXFxN2RteTM4OWwu
ZnNmQGdpdHN0ZXIuZy8KCk9L77yMdGhhbmtzIGZvciByZW1pbmRpbmcgdGhpcy4KCj4KPj4gKy0t
W25vLV1yZWplY3Qtc2hhbGxvdzo6Cj4+ICsJRmFpbCBpZiB0aGUgc291cmNlIHJlcG9zaXRvcnkg
aXMgYSBzaGFsbG93IHJlcG9zaXRvcnkuIFRoZQo+PiArCSdjbG9uZS5yZWplY3RzaGFsbG93JyBj
b25maWd1cmF0aW9uIHZhcmlhYmxlIGNhbiBiZSB1c2VkIHRvCj4+ICsJZ2l2ZSB0aGUgZGVmYXVs
dC4KPgo+TGV0J3MgY2FtZWxDYXNlIHRoZSByZWZlcmVuY2UgdG8gdGhlIHZhcmlhYmxlLCB0b28u
wqAgQWxzbywgdHlwZXNldAo+aW4gbW9ub3NwYWNlLCBpLmUuCj4KPglUaGUgYGNsb25lLnJlamVj
dFNoYWxsb3dgIGNvbmZpZ3VyYXRpb24gdmFyaWFibGUgLi4uCj4KPj4gQEAgLTg1OCw2ICs4NjIs
OSBAQCBzdGF0aWMgaW50IGdpdF9jbG9uZV9jb25maWcoY29uc3QgY2hhciAqaywgY29uc3QgY2hh
ciAqdiwgdm9pZCAqY2IpCj4+wqAgZnJlZShyZW1vdGVfbmFtZSk7Cj4+wqAgcmVtb3RlX25hbWUg
PSB4c3RyZHVwKHYpOwo+PsKgIH0KPj4gKwlpZiAoIXN0cmNtcChrLCAiY2xvbmUucmVqZWN0c2hh
bGxvdyIpKSB7Cj4+ICsJY29uZmlnX3NoYWxsb3cgPSBnaXRfY29uZmlnX2Jvb2woaywgdik7Cj4+
ICsJfQo+Cj5ObyBuZWVkIHRvIHVzZSB7fSBhcm91bmQgYSBzaW5nbGUtc3RhdGVtZW50IGJsb2Nr
LCBlc3BlY2lhbGx5IHdoZW4KPnRoZSAiaWYiIHN0YXRlbWVudCBkb2VzIG5vdCBoYXZlIGFuICJl
bHNlIiBibG9jay4KPgo+VGhlIHVzZSBvZiBzdHJjbXAoKSBhZ2FpbnN0IHRoZSB2YXJpYWJsZSBu
YW1lIGluIGFsbCBsb3dlcmNhc2UgaXMKPmNvcnJlY3QgaGVyZS4KPgo+PiBAQCAtMTE1Niw2ICsx
MTY0LDE2IEBAIGludCBjbWRfY2xvbmUoaW50IGFyZ2MsIGNvbnN0IGNoYXIgKiphcmd2LCBjb25z
dCBjaGFyICpwcmVmaXgpCj4+wqAgKi8KPj7CoCBnaXRfY29uZmlnKGdpdF9jbG9uZV9jb25maWcs
IE5VTEwpOwo+PsKgCj4+ICsJLyoKPj4gKwkqIElmIG9wdGlvbl9zaGFsbG93IGlzIHNwZWNpZmll
ZCBmcm9tIENMSSBvcHRpb24sCj4+ICsJKiBpZ25vcmUgY29uZmlnX3NoYWxsb3cgZnJvbSBnaXRf
Y2xvbmVfY29uZmlnLgo+PiArCSovCj4+ICsJaWYgKGNvbmZpZ19zaGFsbG93ICE9IC0xKSB7Cj4+
ICsJcmVqZWN0X3NoYWxsb3cgPSBjb25maWdfc2hhbGxvdzsKPj4gKwl9Cj4+ICsJaWYgKG9wdGlv
bl9zaGFsbG93ICE9IC0xKSB7Cj4+ICsJcmVqZWN0X3NoYWxsb3cgPSBvcHRpb25fc2hhbGxvdzsK
Pj4gKwl9Cj4KPk5lZWRsZXNzIHVzZSBvZiB7fSBhcm91bmQgc2luZ2xlLXN0YXRlbWVudCBibG9j
a3MuCj4KPkFzIHJlamVjdF9zaGFsbG93IGlzIGluaXRpYWxpemVkIHRvIDAsIHRoaXMgbGV0cyB0
aGUgb3B0aW9uIHRvIGJlIG9mCj50aGUgbW9zdCBwcmlvcml0eSwgdGhlbiB0aGUgY29uZmlnIChw
cmVzdW1hYmx5IGNvbWluZyBmcm9tIHRoZSBwZXItdXNlcgo+b3IgcGVyLXN5c3RlbSBjb25maWd1
cmF0aW9uKSwgYnkgd2l0aG91dCB0aGVtLCBkZWZhdWx0cyB0byBmYWxzZS7CoCBHb29kLgo+Cj5X
ZSdsbCBoYXZlIGFuIGV4dHJhIGdpdF9jb25maWcoKSBjYWxsIGxhdGVyLCBidXQgdGhhdCBvbmUg
d2lsbCBvbmx5Cj5yZWFkIGludG8gY29uZmlnX3NoYWxsb3csIG5ldmVyIHRvIGJlIGxvb2tlZCBh
dCBiZWNhdXNlIHdlIHdpbGwgdXNlCj5yZWplY3Rfc2hhbGxvdyB2YXJpYWJsZSBhbnl3YXkuwqAg
T0suCj4KPj4gQEAgLTEyMTYsNiArMTIzNCw4IEBAIGludCBjbWRfY2xvbmUoaW50IGFyZ2MsIGNv
bnN0IGNoYXIgKiphcmd2LCBjb25zdCBjaGFyICpwcmVmaXgpCj4+wqAgaWYgKGZpbHRlcl9vcHRp
b25zLmNob2ljZSkKPj7CoCB3YXJuaW5nKF8oIi0tZmlsdGVyIGlzIGlnbm9yZWQgaW4gbG9jYWwg
Y2xvbmVzOyB1c2UgZmlsZTovLyBpbnN0ZWFkLiIpKTsKPj7CoCBpZiAoIWFjY2Vzcyhta3BhdGgo
IiVzL3NoYWxsb3ciLCBwYXRoKSwgRl9PSykpIHsKPj4gKwlpZiAocmVqZWN0X3NoYWxsb3cpCj4+
ICsJZGllKCJzb3VyY2UgcmVwb3NpdG9yeSBpcyBzaGFsbG93LCByZWplY3QgdG8gY2xvbmUuIik7
Cj4KPldpdGggdGhlIGxvY2FsIHRyYW5zcG9ydCwgaXQgKGhvcGVmdWxseSkgaXMgdHJpdmlhbCB0
byBzZWUgaWYgdGhlCj5zb3VyY2UgaXMgc2hhbGxvdy7CoCBPSy4KPgo+PsKgIGlmIChvcHRpb25f
bG9jYWwgPiAwKQo+PsKgIHdhcm5pbmcoXygic291cmNlIHJlcG9zaXRvcnkgaXMgc2hhbGxvdywg
aWdub3JpbmcgLS1sb2NhbCIpKTsKPj7CoCBpc19sb2NhbCA9IDA7Cj4+IEBAIC0xMjI3LDYgKzEy
NDcsOCBAQCBpbnQgY21kX2Nsb25lKGludCBhcmdjLCBjb25zdCBjaGFyICoqYXJndiwgY29uc3Qg
Y2hhciAqcHJlZml4KQo+PsKgCj4+wqAgdHJhbnNwb3J0X3NldF9vcHRpb24odHJhbnNwb3J0LCBU
UkFOU19PUFRfS0VFUCwgInllcyIpOwo+PsKgCj4+ICsJaWYgKHJlamVjdF9zaGFsbG93KQo+PiAr
CXRyYW5zcG9ydF9zZXRfb3B0aW9uKHRyYW5zcG9ydCwgVFJBTlNfT1BUX1JFSkVDVF9TSEFMTE9X
LCAiMSIpOwo+PsKgIGlmIChvcHRpb25fZGVwdGgpCj4+wqAgdHJhbnNwb3J0X3NldF9vcHRpb24o
dHJhbnNwb3J0LCBUUkFOU19PUFRfREVQVEgsCj4+wqAgwqDCoMKgwqAgb3B0aW9uX2RlcHRoKTsK
Pgo+T0suwqAgV2hhdCBpcyByZWFsbHkgaW50ZXJlc3Rpbmcgd2lsbCBhbGwgaGFwcGVuIGluc2lk
ZSB0aGUgdHJhbnNwb3J0Cj5sYXllcjsgdGhlIGNhbGxlciBvbmx5IGhhcyB0byBhc2sgZm9yIGl0
Lgo+Cj5UaGUgYXN5bW1ldHJ5IHdpdGggb3RoZXIgb3B0aW9ucyBsaWtlICItLWRlcHRoIiBzdGFu
ZHMgb3V0IGFuZAo+cHV6emxlcyByZWFkZXJzLCB0aG91Z2guCj4gCgpUcnVlLCBidXQgc2luY2Ug
YHJlamVjdF9zaGFsbG93YCBpcyBub3QganVzdCBhbiBvcHRpb24gZnJvbSBDTEksIHNvIEkgdGhp
bmsKd2UgY2FuJ3QganVzdCBjYWxswqBpdCAib3B0aW9uX3NoYWxsb3ciIGhlcmUgdG8gb3JkZXIg
dG8ga2VlcCBzeW1tZXRyeQp3aXRoIG90aGVyIG9wdGlvbnMgYmVsb3cuCgo+RG8gd2UgcmVhbGx5
IHdhbnQgdG8gYWRkIHRoZSBjbG9uZS5yZWplY3RTaGFsbG93IGNvbmZpZ3VyYXRpb24/IAoKT25s
eSB3aGVuIEkgd2FudCBhbGwgbXkgZ2l0IGNsb25lIGluIG15IG1hY2hpbmUgY2FuIGF2b2lkwqBj
bG9uaW5nCnNoYWxsb3cgcmVwbywgYW5kIG5vIG5lZWQgdG8gcHJvdmlkZSB0aGUgb3B0aW9uICIt
LXJlamVjdC1zaGFsbG93IgpldmVyeSB0aW1lLCB0aGVuIHRoaXMgY29uZmlndXJhdGlvbiB3b3Vs
ZCBtYWtlIHNlbnNlLgoKPkFmdGVyIGFsbCwgd2UgZG8gbm90IGdpdmUgImNsb25lLmRlcHRoID0g
MSIgZXRjLiwgYW5kIHRoYXQgaXMgdGhlCj5yZWFzb24gd2h5IHdlIG9ubHkgbmVlZCAiaWYgKG9w
dGlvbl9kZXB0aCkiIGhlcmUgaW4gdGhlIG5lYXItYnkKPmNvZGUuCj4KPkknZCBzdG9wIGhlcmUg
Zm9yIHRvZGF5LCBob3BpbmcgdGhhdCBzb21lYm9keSBtdWNoIG1vcmUgZmFtaWxpYXIKPndpdGgg
dGhlIHRyYW5zcG9ydCBsYXllciB0aGFuIEkgYW0gd2lsbCByZXZpZXcgYW5kIGNvbW1lbnQgb24g
dGhlCj5jaGFuZ2VzIHRoZXJlLgo+Cj5UaGFua3MuCj4=

