From: Karl Wiberg <kha@treskal.com>
Subject: Re: [ANNOUNCE] Stacked Git 0.15
Date: Mon, 26 Oct 2009 14:49:15 +0100
Message-ID: <20091026134915.GA1565@diana.vm.bytemark.co.uk>
References: <b0943d9e0910241541n7b1091ecp6b21fa896405afa0@mail.gmail.com> <m34opoe5t6.fsf@localhost.localdomain> <b0943d9e0910251013v19fb39b7we412e7f734c2755f@mail.gmail.com> <b0943d9e0910260332x1ca40f97r351e94f5baeb1c6b@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Cc: Jakub Narebski <jnareb@gmail.com>,
	Git Mailing List <git@vger.kernel.org>
To: Catalin Marinas <catalin.marinas@gmail.com>
X-From: git-owner@vger.kernel.org Mon Oct 26 15:09:10 2009
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git-2@lo.gmane.org
Received: from vger.kernel.org ([209.132.176.167])
	by lo.gmane.org with esmtp (Exim 4.50)
	id 1N2QFu-0005Uw-80
	for gcvg-git-2@lo.gmane.org; Mon, 26 Oct 2009 15:09:06 +0100
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1751707AbZJZOH6 (ORCPT <rfc822;gcvg-git-2@m.gmane.org>);
	Mon, 26 Oct 2009 10:07:58 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1751307AbZJZOH5
	(ORCPT <rfc822;git-outgoing>); Mon, 26 Oct 2009 10:07:57 -0400
Received: from diana.vm.bytemark.co.uk ([80.68.90.142]:43137 "EHLO
	diana.vm.bytemark.co.uk" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1751293AbZJZOH5 (ORCPT <rfc822;git@vger.kernel.org>);
	Mon, 26 Oct 2009 10:07:57 -0400
X-Greylist: delayed 1122 seconds by postgrey-1.27 at vger.kernel.org; Mon, 26 Oct 2009 10:07:57 EDT
Received: from kha by diana.vm.bytemark.co.uk with local (Exim 3.36 #1 (Debian))
	id 1N2Pwh-0000QH-00; Mon, 26 Oct 2009 13:49:15 +0000
Content-Disposition: inline
In-Reply-To: <b0943d9e0910260332x1ca40f97r351e94f5baeb1c6b@mail.gmail.com>
X-Manual-Spam-Check: kha@treskal.com, clean
User-Agent: Mutt/1.5.9i
Sender: git-owner@vger.kernel.org
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/131251>

On 2009-10-26 10:32:07 +0000, Catalin Marinas wrote:

> The problem was a bit more complicated than this. Some files are
> generated by the Makefile rather than setup.py so using the latter
> directly fails to build anything.
>
> So it's time for 0.15.1 this week with the fix below (in my
> "proposed" branch). I cc'ed Karl as well in case he has time to have
> a quick look.

I don't have any objections, except ...

> diff --git a/Makefile b/Makefile
> index 0fa5c6a..5f88f7d 100644
> --- a/Makefile
> +++ b/Makefile
> @@ -4,20 +4,10 @@ PYTHON	?= python
> 
>  TEST_PATCHES ?= ..
> 
> -all: build
> +all:
>  	$(PYTHON) setup.py build
> 
> -build: stgit/commands/cmdlist.py stgit-completion.bash
> -
> -ALL_PY = $(shell find stgit -name '*.py')
> -
> -stgit/commands/cmdlist.py: $(ALL_PY)
> -	$(PYTHON) stg-build --py-cmd-list > $@
> -
> -stgit-completion.bash: $(ALL_PY)
> -	$(PYTHON) stg-build --bash-completion > $@
> -
> -install: build
> +install:
>  	$(PYTHON) setup.py install --prefix=$(prefix) --root=$(DESTDIR) --force
> 
>  doc:
> @@ -29,10 +19,10 @@ install-doc:
>  install-html:
>  	$(MAKE) -C Documentation install-html
> 
> -test: build
> +test:
>  	cd t && $(MAKE) all

... don't we need to run "setup.py build" here in order to not change
the behavior?

-- 
Karl Wiberg, kha@treskal.com
    www.treskal.com/kalle
