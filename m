From: Junio C Hamano <gitster@pobox.com>
Subject: Re: [PATCH] Bugfix: undefined htmldir in config.mak.autogen
Date: Tue, 19 Feb 2013 11:11:00 -0800
Message-ID: <7vfw0s5dbv.fsf@alter.siamese.dyndns.org>
References: <1be0a520b99fbfecd7255c1d26753015612856b3.1361272864.git.worldhello.net@gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Cc: "Christoph J. Thompson" <cjsthompson@gmail.com>,
	Git List <git@vger.kernel.org>
To: Jiang Xin <worldhello.net@gmail.com>
X-From: git-owner@vger.kernel.org Tue Feb 19 20:11:47 2013
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git-2@plane.gmane.org
Received: from vger.kernel.org ([209.132.180.67])
	by plane.gmane.org with esmtp (Exim 4.69)
	(envelope-from <git-owner@vger.kernel.org>)
	id 1U7sbO-0005wC-Ub
	for gcvg-git-2@plane.gmane.org; Tue, 19 Feb 2013 20:11:43 +0100
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S934572Ab3BSTLH (ORCPT <rfc822;gcvg-git-2@m.gmane.org>);
	Tue, 19 Feb 2013 14:11:07 -0500
Received: from b-pb-sasl-quonix.pobox.com ([208.72.237.35]:63350 "EHLO
	smtp.pobox.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
	id S934569Ab3BSTLE (ORCPT <rfc822;git@vger.kernel.org>);
	Tue, 19 Feb 2013 14:11:04 -0500
Received: from smtp.pobox.com (unknown [127.0.0.1])
	by b-sasl-quonix.pobox.com (Postfix) with ESMTP id E0693A754;
	Tue, 19 Feb 2013 14:11:02 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; s=sasl; bh=VK9/S0Ns6ZNkf1IkShBB3ZWj7ug=; b=iWPv/8
	V9KCN6ZxoECzZLOkHL8Uj7tn4VGkQR7lADGZigGVU6OMRR1mGQcOWz/d8xMjCQlh
	PQEjswP33IBmO3QB84JmajV/pK32bEdPeDF1hHbaDouF7NCFYSwU9T729ylscUXu
	HRz2Y7ut14iWGvW1GUKqnfBT/hNFoSwU7cHoY=
DomainKey-Signature: a=rsa-sha1; c=nofws; d=pobox.com; h=from:to:cc
	:subject:references:date:in-reply-to:message-id:mime-version
	:content-type; q=dns; s=sasl; b=ECHYlXd7WDoVgg5INEaAU59zxq7d50+R
	gSGSmY5QM1i+tCbU+trwIeDPkIM9GN/0j6JtGY39auLHkVIv68EBxb/DurETzc5m
	dLrVeTKR+ZqznGPL63Tp01fwh4MP2U4o90AomFtCVlA5Fwy/rtU7F3NTje+TxHrO
	/Hiyk1Mak1k=
Received: from b-pb-sasl-quonix.pobox.com (unknown [127.0.0.1])
	by b-sasl-quonix.pobox.com (Postfix) with ESMTP id D5455A753;
	Tue, 19 Feb 2013 14:11:02 -0500 (EST)
Received: from pobox.com (unknown [98.234.214.94]) (using TLSv1 with cipher
 DHE-RSA-AES128-SHA (128/128 bits)) (No client certificate requested) by
 b-sasl-quonix.pobox.com (Postfix) with ESMTPSA id 358BEA752; Tue, 19 Feb 2013
 14:11:02 -0500 (EST)
In-Reply-To: <1be0a520b99fbfecd7255c1d26753015612856b3.1361272864.git.worldhello.net@gmail.com> (Jiang Xin's message of "Tue, 19 Feb 2013 19:23:29 +0800")
User-Agent: Gnus/5.13 (Gnus v5.13) Emacs/23.2 (gnu/linux)
X-Pobox-Relay-ID: 19F800EE-7AC8-11E2-9EC9-21622E706CDE-77302942!b-pb-sasl-quonix.pobox.com
Sender: git-owner@vger.kernel.org
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/216650>

Jiang Xin <worldhello.net@gmail.com> writes:

> Html documents will be installed to root dir (/) no matter what prefix
> is set, if run these commands before `make` and `make install-html`:
>
>     $ make configure
>     $ ./configure --prefix=<PREFIX>
>
> After the installation, all the html documents will copy to rootdir (/),
> and:
>
>     $ git --html-path
>     <PREFIX>
>
>     $ git help -w something
>     fatal: '<PREFIX>': not a documentation directory.
>
> This is because the variable "htmldir" points to a undefined variable
> "$(docdir)" in file "config.mak.autogen", which is generated by running
> `./configure`. This bug comes from commit fc1c541 (Honor configure's
> htmldir switch), since v1.8.1.3-537-g1d321.
>
> Add the required two variables "PACKAGE_TARNAME" and "docdir" to file
> "config.mak.in" will resolve this problem.
>
> Signed-off-by: Jiang Xin <worldhello.net@gmail.com>
> ---

Who references PACKAGE_TARNAME and how is the symbol used?

>  config.mak.in | 2 ++
>  1 file changed, 2 insertions(+)
>
> diff --git a/config.mak.in b/config.mak.in
> index d7c49..fa02bd 100644
> --- a/config.mak.in
> +++ b/config.mak.in
> @@ -8,6 +8,7 @@ LDFLAGS = @LDFLAGS@
>  AR = @AR@
>  TAR = @TAR@
>  DIFF = @DIFF@
> +PACKAGE_TARNAME = @PACKAGE_TARNAME@
>  #INSTALL = @INSTALL@		# needs install-sh or install.sh in sources
>  
>  prefix = @prefix@
> @@ -17,6 +18,7 @@ gitexecdir = @libexecdir@/git-core
>  datarootdir = @datarootdir@
>  template_dir = @datadir@/git-core/templates
>  sysconfdir = @sysconfdir@
> +docdir = @docdir@
>  
>  mandir = @mandir@
>  htmldir = @htmldir@
