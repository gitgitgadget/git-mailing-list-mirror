From: Carlos =?ISO-8859-1?Q?Mart=EDn?= Nieto <cmn@elego.de>
Subject: Re: How to force git to use authentication as author
Date: Thu, 14 Jul 2011 13:38:02 +0200
Message-ID: <1310643482.6041.17.camel@centaur.lab.cmartin.tk>
References: <20110714160638.065b6542@shiva.selfip.org>
	 <CACBZZX4X8qRBXqwi70kZ0eZ+mb7rdD6p36xD=GoX6soha0TZcg@mail.gmail.com>
	 <20110714161838.1e30893a@shiva.selfip.org>
	 <1310641202.18730.16.camel@bee.lab.cmartin.tk>
	 <20110714164547.0b359e60@shiva.selfip.org>
Mime-Version: 1.0
Content-Type: multipart/signed; micalg="pgp-sha1"; protocol="application/pgp-signature"; boundary="=-kkavHKFYmrtaLM7OIuoE"
Cc: =?ISO-8859-1?Q?=C6var_Arnfj=F6r=F0?= Bjarmason <avarab@gmail.com>,
	git@vger.kernel.org
To: "J. Bakshi" <joydeep@infoservices.in>
X-From: git-owner@vger.kernel.org Thu Jul 14 13:38:38 2011
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git-2@lo.gmane.org
Received: from vger.kernel.org ([209.132.180.67])
	by lo.gmane.org with esmtp (Exim 4.69)
	(envelope-from <git-owner@vger.kernel.org>)
	id 1QhKFY-0007DI-Ep
	for gcvg-git-2@lo.gmane.org; Thu, 14 Jul 2011 13:38:36 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1754284Ab1GNLib (ORCPT <rfc822;gcvg-git-2@m.gmane.org>);
	Thu, 14 Jul 2011 07:38:31 -0400
Received: from kimmy.cmartin.tk ([91.121.65.165]:39696 "EHLO kimmy.cmartin.tk"
	rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
	id S1753245Ab1GNLib (ORCPT <rfc822;git@vger.kernel.org>);
	Thu, 14 Jul 2011 07:38:31 -0400
Received: from [192.168.1.15] (brln-d9ba36b2.pool.mediaWays.net [217.186.54.178])
	by kimmy.cmartin.tk (Postfix) with ESMTPSA id 29906461FA;
	Thu, 14 Jul 2011 13:37:35 +0200 (CEST)
In-Reply-To: <20110714164547.0b359e60@shiva.selfip.org>
X-Mailer: Evolution 2.32.3 
Sender: git-owner@vger.kernel.org
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/177118>


--=-kkavHKFYmrtaLM7OIuoE
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

On Thu, 2011-07-14 at 16:45 +0530, J. Bakshi wrote:
> On Thu, 14 Jul 2011 13:00:02 +0200
> Carlos Mart=C3=ADn Nieto <cmn@elego.de> wrote:
>=20
> > On Thu, 2011-07-14 at 16:18 +0530, J. Bakshi wrote:
> > > On Thu, 14 Jul 2011 12:38:59 +0200
> > > =C3=86var Arnfj=C3=B6r=C3=B0 Bjarmason <avarab@gmail.com> wrote:
> > >=20
> > > > On Thu, Jul 14, 2011 at 12:36, J. Bakshi <joydeep@infoservices.in>
> > > wrote:
> > > >=20
> > > > > How can I force git to use the username as define
> > > at /home/git/PASSWD as the author name for git commit ?
> > > >=20
> > > > Edit the global bashrc to have:
> > > >=20
> > > >     export GIT_AUTHOR_NAME=3D$(cat ~/PASSWD)
> > > >=20
> > > > ?
> > >=20
> > > Thanks.=20
> > >=20
> > > [1] will it work with file generated by htpasswd ? as that file is
> > > actually created by same (/home/git/PASSWD)
> >=20
> > Not directly, if it only has one line, then $(cat ~/PASSWD | cut -d ':'
> > -f 1) should work, but I haven't tested it.
> >=20
> > >=20
> > > [2] And the commit is over http, So is it effective to set the value
> > > by .bashrc ?
> >=20
> > You are misunderstanding either how git works or the nomenclature. The
> > commits all happen locally and need no authentication whatsoever (and
> > usually you're expected to use a real name and email address). When you
> > need to authenticate is when yuou push your changes somewhere (a centra=
l
> > repo, for example). This is where the ~/.netrc file comes into play, as
> > I mentioned in the reply to your other mail.
> >=20
> Exactly, when we need to push we are asked about authentication. I
> like to configure the central git server in a way so that the
> user-name as in authentication, be set as author name by the git
> server itself. actually it is how I configured svn server over http.
> So comparing to that I am trying to achieve the same. Say your
> user-name is there at htpasswd file as Carlos, so when you
> authenticate by Carlos to push , the author-name will automatically
> become as Carlos. No way to customize that with specific username.
> That's the idea.

That's not how it works. It may even be possible to rewrite the commits
in the post-receive hook in a way that most stuff doesn't break
horribly, this would be rewriting history behind the users' backs, and
that only brings problems.

The way to set the author name and mail in a standard way, be it
user-wide or per-repo. You can write up some simple instructions on how
to do it.

    git config user.name "Max Smith"
    git config user.mail max.smith@example.com

and if the config should be valid for every repo, use --global flag.
There is more information in the manual page.

You could then add a check in the post-receive hook to reject pushes
with invalid author names, if you feel it's worth it.

Taking a step back, why is this even an issue, though? If you don't
trust your developers to set their name and email correctly, why do you
trust them to write code? If it's company policy for people to be
referred to by their usernames rather than their given names, why not
tell them to set it to that[0]? It seems like you are trying to solve a
social issue with a technological measure that works at a different
level.

[0] and given that they're probably using their company email address,
it wouldn't be a problem to get a unique ID for each developer if that's
what you need.

Cheers,
   cmn

--=-kkavHKFYmrtaLM7OIuoE
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: This is a digitally signed message part

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iQEcBAABAgAGBQJOHtUWAAoJEHKRP1jG7ZzTzCsIAIVCBxVAmNgjcmKgh2cTbg0V
B88bDC4onBSGgbCcMXqGrzcZyKky6cqWP0r/OwsFyozXfGaiAZoMLtAbmNHJo99L
Q0+CfGKpDaXpcVpDXpITs0HNQeP8hRdT0dwzHLpwBrC/ru+z+S4SzOm4vzaxOw3k
i+YhpB6hmuBKTPIdz+u1Hc5cxyfEnt7NeBiVMk4ndKDw6eCxZuoW7wvWedf7Mbgc
wG7ih5k/erjEA+lRWez/cbMJLD6YeKXNBvvooMSLN8iEDidGHekGvvm2/j91Y0wJ
rtGX5kHeSTe6b2Ky7nS+90g9Uh7nOzLRG9EDgqgquB24UZAAFbDKVFqNKeABZQ4=
=75on
-----END PGP SIGNATURE-----

--=-kkavHKFYmrtaLM7OIuoE--
