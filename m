From: Karthik Nayak <karthik.188@gmail.com>
Subject: Re: t3203: --sort=objectsize failure on Windows
Date: Sat, 24 Oct 2015 19:55:58 +0530
Message-ID: <CAOLa=ZRB6_jyyg-M7h8EMtNt96VhXF2hvvKp9OGMvXyJEZB1mw@mail.gmail.com>
References: <562B3807.2030203@kdbg.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Cc: Git Mailing List <git@vger.kernel.org>
To: Johannes Sixt <j6t@kdbg.org>
X-From: git-owner@vger.kernel.org Sat Oct 24 16:26:41 2015
Return-path: <git-owner@vger.kernel.org>
Envelope-to: gcvg-git-2@plane.gmane.org
Received: from vger.kernel.org ([209.132.180.67])
	by plane.gmane.org with esmtp (Exim 4.69)
	(envelope-from <git-owner@vger.kernel.org>)
	id 1ZpzmD-00037Y-IP
	for gcvg-git-2@plane.gmane.org; Sat, 24 Oct 2015 16:26:33 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1751283AbbJXO03 (ORCPT <rfc822;gcvg-git-2@m.gmane.org>);
	Sat, 24 Oct 2015 10:26:29 -0400
Received: from mail-vk0-f54.google.com ([209.85.213.54]:35062 "EHLO
	mail-vk0-f54.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1750936AbbJXO02 (ORCPT <rfc822;git@vger.kernel.org>);
	Sat, 24 Oct 2015 10:26:28 -0400
Received: by vkfw189 with SMTP id w189so77438155vkf.2
        for <git@vger.kernel.org>; Sat, 24 Oct 2015 07:26:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :cc:content-type;
        bh=joli8g6qcXkuPYuw9Vso0JFywcdRYwq2We4OCyv4+Xk=;
        b=Ux91JXeBcVZhZGzMdXsmK4/iqkuJvLjXmSfdhG01uGU8R4jUbDWOvw3ZeuMsD2wLBl
         hcrIWs81gRLdMydSASH1hmlYjm4wojcxHLI4XIEAu7izgrlWFoCadnq8rkyhkAMLvz1q
         hcSknJQKvDcvWxRhxg686qbcZUrfICKbXsBRdrLwk2da59oqmdF3KGrmi7r9c6XYjxpb
         uZgP+RGuqPcwAB+3X5+O5eJYZFPwz/QMVRPejIVMNqsq+1rExxfva3AyRa/sWkzLKG+3
         B3L7MQSi9XUXrpQP1v9l1Jd3I5kTP/+iEGzETMRzJRp7yubilPrB6dJQJC6yRQkLT/hX
         VGcg==
X-Received: by 10.31.172.6 with SMTP id v6mr7641551vke.97.1445696787441; Sat,
 24 Oct 2015 07:26:27 -0700 (PDT)
Received: by 10.103.0.7 with HTTP; Sat, 24 Oct 2015 07:25:58 -0700 (PDT)
In-Reply-To: <562B3807.2030203@kdbg.org>
Sender: git-owner@vger.kernel.org
Precedence: bulk
List-ID: <git.vger.kernel.org>
X-Mailing-List: git@vger.kernel.org
Archived-At: <http://permalink.gmane.org/gmane.comp.version-control.git/280121>

On Sat, Oct 24, 2015 at 1:19 PM, Johannes Sixt <j6t@kdbg.org> wrote:
> On Windows, I observe a failure of the test case 'git branch `--sort`
> option' introduced by aedcb7dc (branch.c: use 'ref-filter' APIs). The reason
> is that the resulting order generated by qsort is unspecified for entries
> that compare equal. In fact, the test case sorts 4 entries where there are
> only 2 different values.

Thanks for reporting the error. Although I couldn't reproduce this on
a Linux environment.
I get what the problem is.

>
> To achieve a deterministic order, perhaps cmp_ref_sorting() should fall back
> to alphabetic comparison if the other criterion (when used) compares equal?
>

Seems like a simple and good way to go around this. will reply with a patch.

-- 
Regards,
Karthik Nayak
